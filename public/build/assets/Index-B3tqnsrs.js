import{d as U,r as A,c as f,w as b,a as s,e as m,f as u,u as r,o as l,l as p,m as g,v as I,b as i,F as y,g as h,t as n,p as x,s as R,n as k,j as q,h as S}from"./app-DarICuOq.js";import{_ as B}from"./AppLayout.vue_vue_type_script_setup_true_lang-Fcs-c9_i.js";import{r as _}from"./routes-C8N3XD_S.js";import{u as H}from"./useSweetAlert-CjcY7Pj8.js";import{u as $}from"./BootstrapLayout-BQuuXWrC.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const K={class:"d-flex justify-content-between align-items-center mb-4"},G={class:"card mb-4"},O={class:"card-body"},J={class:"row g-3"},W={class:"col-md-3"},X={class:"col-md-3"},Y=["value"],Z={class:"col-md-2"},Q={class:"col-md-2"},ss={class:"card"},es={class:"table-responsive"},ts={class:"table table-hover mb-0"},ls={class:"d-flex align-items-center"},is={class:"flex-shrink-0 me-3"},ns={key:0,class:"bg-light rounded overflow-hidden d-flex align-items-center justify-content-center",style:{width:"110px",height:"110px"}},os=["src","alt"],as={key:1,class:"bg-light rounded d-flex align-items-center justify-content-center",style:{width:"110px",height:"110px"}},rs={class:"fw-medium"},ds={class:"text-muted small"},us={class:"align-middle"},cs={key:1,class:"badge bg-secondary"},ms={class:"align-middle"},_s={class:"text-dark"},fs={class:"align-middle"},bs={class:"align-middle"},ps={class:"d-flex align-items-center"},gs={class:"text-muted ms-1"},vs={class:"align-middle"},ys={key:0},hs={class:"small"},xs={key:0},ks={key:1},ws={key:2},Cs={key:1,class:"text-muted small"},Ss={class:"align-middle"},js={key:0,class:"badge bg-danger"},Es={key:1,class:"badge bg-warning text-dark"},Ms={key:2,class:"badge bg-success"},Ts={class:"text-end align-middle"},Vs={class:"btn-group",role:"group"},Ps=["onClick"],Fs={key:0,class:"card-footer"},Ds={class:"d-flex justify-content-between align-items-center"},Ls={class:"d-none d-md-block"},Ns={class:"text-muted mb-0"},Us={class:"fw-medium"},As={class:"fw-medium"},Is={class:"fw-medium"},Rs={class:"pagination pagination-sm mb-0"},qs=["innerHTML"],Bs=U({__name:"Index",props:{products:{},categories:{},filters:{}},setup(d){const{canCreate:j,canEdit:E,canDelete:M}=$(),T=d,{success:w,error:C,confirm:V}=H(),P=o=>new Intl.NumberFormat("fr-FR").format(o)+" Fcfa",F=o=>new Date(o).toLocaleDateString("fr-FR"),a=A({...T.filters}),D=(o,t)=>o===0?"text-danger":o<=t?"text-warning":"text-success",c=()=>{S.get(_("products.index"),a.value,{preserveState:!0,replace:!0})},L=()=>{a.value={},c()},N=async o=>{await V(`Êtes-vous sûr de vouloir supprimer le produit "${o.name}" ?`)&&S.delete(_("products.destroy",{id:o.id}),{onSuccess:e=>{e.props?.flash?.success?w(e.props.flash.success):w(`Produit "${o.name}" supprimé avec succès !`)},onError:e=>{if(e&&typeof e=="object"){const v=Object.values(e)[0];v&&C(v)}else C("Erreur lors de la suppression du produit.")}})};return(o,t)=>(l(),f(B,null,{default:b(()=>[s("div",K,[t[5]||(t[5]=s("div",null,[s("h1",{class:"h2 mb-1"},[s("i",{class:"bi bi-box me-2"}),u(" Produits ")]),s("p",{class:"text-muted mb-0"},"Gérez votre inventaire de produits")],-1)),r(j)("products")?(l(),f(r(p),{key:0,href:r(_)("products.create"),class:"btn btn-primary"},{default:b(()=>[...t[4]||(t[4]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),u(" Ajouter un produit ",-1)])]),_:1},8,["href"])):m("",!0)]),s("div",G,[s("div",O,[s("div",J,[s("div",W,[t[6]||(t[6]=s("label",{class:"form-label"},"Recherche",-1)),g(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.search=e),type:"text",placeholder:"Nom, SKU ou code-barres...",class:"form-control",onInput:c},null,544),[[I,a.value.search]])]),s("div",X,[t[8]||(t[8]=s("label",{class:"form-label"},"Catégorie",-1)),g(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.category_id=e),class:"form-select",onChange:c},[t[7]||(t[7]=s("option",{value:""},"Toutes les catégories",-1)),(l(!0),i(y,null,h(d.categories,e=>(l(),i("option",{key:e.id,value:e.id},n(e.name),9,Y))),128))],544),[[x,a.value.category_id]])]),s("div",Z,[t[10]||(t[10]=s("label",{class:"form-label"},"Statut du stock",-1)),g(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.value.stock_status=e),class:"form-select",onChange:c},[...t[9]||(t[9]=[s("option",{value:""},"Tous",-1),s("option",{value:"low"},"Stock faible",-1),s("option",{value:"out"},"Rupture de stock",-1)])],544),[[x,a.value.stock_status]])]),s("div",Q,[t[12]||(t[12]=s("label",{class:"form-label"},"Expiration",-1)),g(s("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.value.expiration_alert=e),class:"form-select",onChange:c},[...t[11]||(t[11]=[s("option",{value:""},"Tous",-1),s("option",{value:!0},"Expirés/Proches",-1)])],544),[[x,a.value.expiration_alert]])]),s("div",{class:"col-md-3 d-flex align-items-end"},[s("button",{onClick:L,class:"btn btn-outline-secondary w-100"},[...t[13]||(t[13]=[s("i",{class:"bi bi-x-circle me-1"},null,-1),u(" Effacer les filtres ",-1)])])])])])]),s("div",ss,[s("div",es,[s("table",ts,[t[18]||(t[18]=s("thead",{class:"table-light"},[s("tr",null,[s("th",null,"Produit"),s("th",null,"Catégorie"),s("th",null,"SKU"),s("th",null,"Prix"),s("th",null,"Stock"),s("th",null,"Expiration"),s("th",null,"Statut"),s("th",{class:"text-end"},"Actions")])],-1)),s("tbody",null,[(l(!0),i(y,null,h(d.products.data,e=>(l(),i("tr",{key:e.id},[s("td",null,[s("div",ls,[s("div",is,[e.image_url?(l(),i("div",ns,[s("img",{src:e.image_url,alt:e.name,class:"img-fluid",style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,os)])):(l(),i("div",as,[...t[14]||(t[14]=[s("i",{class:"bi bi-box text-muted fs-5"},null,-1)])]))]),s("div",null,[s("div",rs,n(e.name),1),s("div",ds,n(e.description||"Aucune description"),1)])])]),s("td",us,[e.category?(l(),i("span",{key:0,class:"badge",style:R({backgroundColor:e.category.color+"20",color:e.category.color})},n(e.category.name),5)):(l(),i("span",cs," Catégorie supprimée "))]),s("td",ms,[s("code",_s,n(e.sku),1)]),s("td",fs,n(P(e.price)),1),s("td",bs,[s("div",ps,[s("span",{class:k(["fw-medium",D(e.stock_quantity,e.min_stock_level)])},n(e.stock_quantity),3),s("span",gs,n(e.unit),1)])]),s("td",vs,[e.expiration_date?(l(),i("div",ys,[s("div",hs,n(F(e.expiration_date)),1),e.days_until_expiration!==null&&e.days_until_expiration!==void 0?(l(),i("span",{key:0,class:k(["badge",(e.days_until_expiration??0)<0||(e.days_until_expiration??0)===0?"bg-danger":(e.days_until_expiration??0)<=7?"bg-warning text-dark":"bg-info"])},[(e.days_until_expiration??0)<0?(l(),i("span",xs," Expiré ("+n(Math.abs(e.days_until_expiration??0))+"j) ",1)):(e.days_until_expiration??0)===0?(l(),i("span",ks," Expire aujourd'hui ")):(l(),i("span",ws,n(e.days_until_expiration)+" jour(s) ",1))],2)):m("",!0)])):(l(),i("span",Cs,"-"))]),s("td",Ss,[e.stock_quantity===0?(l(),i("span",js," Rupture ")):e.stock_quantity<=e.min_stock_level?(l(),i("span",Es," Stock faible ")):(l(),i("span",Ms," En stock "))]),s("td",Ts,[s("div",Vs,[q(r(p),{href:r(_)("products.show",{id:e.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:b(()=>[...t[15]||(t[15]=[s("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),r(E)("products")?(l(),f(r(p),{key:0,href:r(_)("products.edit",{id:e.id}),class:"btn btn-sm btn-outline-secondary",title:"Modifier"},{default:b(()=>[...t[16]||(t[16]=[s("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"])):m("",!0),r(M)("products")?(l(),i("button",{key:1,onClick:v=>N(e),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...t[17]||(t[17]=[s("i",{class:"bi bi-trash"},null,-1)])],8,Ps)):m("",!0)])])]))),128))])])]),d.products.links?(l(),i("div",Fs,[s("div",Ds,[s("div",Ls,[s("p",Ns,[t[19]||(t[19]=u(" Affichage de ",-1)),s("span",Us,n(d.products.from),1),t[20]||(t[20]=u(" à ",-1)),s("span",As,n(d.products.to),1),t[21]||(t[21]=u(" sur ",-1)),s("span",Is,n(d.products.total),1),t[22]||(t[22]=u(" résultats ",-1))])]),s("nav",null,[s("ul",Rs,[(l(!0),i(y,null,h(d.products.links,e=>(l(),i("li",{key:e.label,class:k(["page-item",{active:e.active,disabled:!e.url}])},[e.url?(l(),f(r(p),{key:0,href:e.url,class:"page-link",innerHTML:e.label},null,8,["href","innerHTML"])):(l(),i("span",{key:1,class:"page-link",innerHTML:e.label},null,8,qs))],2))),128))])])])])):m("",!0)])]),_:1}))}}),Ws=z(Bs,[["__scopeId","data-v-82800ed5"]]);export{Ws as default};
