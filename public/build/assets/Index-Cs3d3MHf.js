import{E as X,G as $,H as J,d as K,r as M,y as E,c as O,w as L,a as e,b,e as R,j,f as U,u as m,l as S,t as a,m as I,v as B,p as q,o as f,F as z,g as G,n as Y,h as Z}from"./app-CGJPUJEO.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-DOygplc7.js";import{r as F}from"./routes-C8N3XD_S.js";import{u as te}from"./useSweetAlert-CjcY7Pj8.js";import{g as se,f as ne,b as ie}from"./BootstrapLayout-Bp9zEE-w.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-NNS-RXd7.js";var oe=/\s/;function ae(n){for(var l=n.length;l--&&oe.test(n.charAt(l)););return l}var re=/^\s+/;function de(n){return n&&n.slice(0,ae(n)+1).replace(re,"")}var P=NaN,ue=/^[-+]0x[0-9a-f]+$/i,ce=/^0b[01]+$/i,me=/^0o[0-7]+$/i,fe=parseInt;function Q(n){if(typeof n=="number")return n;if(X(n))return P;if($(n)){var l=typeof n.valueOf=="function"?n.valueOf():n;n=$(l)?l+"":l}if(typeof n!="string")return n===0?n:+n;n=de(n);var u=ce.test(n);return u||me.test(n)?fe(n.slice(2),u?2:8):ue.test(n)?P:+n}var W=function(){return J.Date.now()},ve="Expected a function",be=Math.max,pe=Math.min;function he(n,l,u){var p,g,v,d,o,r,c=0,w=!1,_=!1,T=!0;if(typeof n!="function")throw new TypeError(ve);l=Q(l)||0,$(u)&&(w=!!u.leading,_="maxWait"in u,v=_?be(Q(u.maxWait)||0,l):v,T="trailing"in u?!!u.trailing:T);function k(t){var s=p,h=g;return p=g=void 0,c=t,d=n.apply(h,s),d}function V(t){return c=t,o=setTimeout(C,l),w?k(t):d}function N(t){var s=t-r,h=t-c,H=l-s;return _?pe(H,v-h):H}function y(t){var s=t-r,h=t-c;return r===void 0||s>=l||s<0||_&&h>=v}function C(){var t=W();if(y(t))return x(t);o=setTimeout(C,N(t))}function x(t){return o=void 0,T&&p?k(t):(p=g=void 0,d)}function A(){o!==void 0&&clearTimeout(o),c=0,p=r=g=o=void 0}function D(){return o===void 0?d:x(W())}function i(){var t=W(),s=y(t);if(p=arguments,g=this,r=t,s){if(o===void 0)return V(r);if(_)return clearTimeout(o),o=setTimeout(C,l),k(r)}return o===void 0&&(o=setTimeout(C,l)),d}return i.cancel=A,i.flush=D,i}const ge={class:"d-flex justify-content-between align-items-center mb-4"},_e={class:"row mb-4"},ye={class:"col-md-3"},xe={class:"card bg-primary text-white"},Ce={class:"card-body"},we={class:"d-flex justify-content-between"},Te={class:"mb-0"},ke={class:"col-md-3"},Me={class:"card bg-info text-white"},Ee={class:"card-body"},Ie={class:"d-flex justify-content-between"},Ne={class:"card-title"},Le={class:"mb-0"},Se={class:"col-md-3"},Fe={class:"card bg-warning text-white"},Ve={class:"card-body"},Ae={class:"d-flex justify-content-between"},De={class:"mb-0"},je={class:"col-md-3"},Ue={class:"card bg-success text-white"},Be={class:"card-body"},We={class:"d-flex justify-content-between"},$e={class:"mb-0"},He={class:"card mb-4"},Oe={class:"card-body"},Re={class:"row g-3"},qe={class:"col-md-3"},ze={class:"col-md-2"},Ge={class:"col-md-2"},Pe={class:"col-md-2"},Qe={class:"col-md-2"},Xe={class:"card"},Je={class:"card-body p-0"},Ke={key:0,class:"text-center py-5"},Ye={key:1,class:"table-responsive"},Ze={class:"table table-hover mb-0"},et={class:"badge bg-primary"},tt={class:"fw-medium"},st={key:0,class:"text-muted small"},nt={class:"badge bg-info"},it={class:"fw-bold text-danger"},lt={class:"badge bg-secondary"},ot={class:"text-muted small"},at={class:"d-flex align-items-center"},rt={class:"avatar-sm bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2"},dt={class:"fw-medium"},ut={class:"btn-group",role:"group"},ct=["onClick"],mt={key:0,class:"d-flex justify-content-center mt-4"},ft={class:"pagination"},vt=["innerHTML"],bt=K({__name:"Index",props:{expenses:{},statistics:{}},setup(n){const l=n,{success:u,error:p,confirm:g}=te(),v=M(""),d=M(""),o=M(""),r=M(""),c=M(""),w=he(()=>{},300),_=E(()=>l.statistics?.total||0),T=E(()=>l.statistics?.monthly||0),k=E(()=>l.statistics?.weekly||0),V=E(()=>{const i=se();return i.charAt(0).toUpperCase()+i.slice(1)}),N=E(()=>{let i=l.expenses.data;if(v.value){const t=v.value.toLowerCase();i=i.filter(s=>s.title.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)||s.vendor?.toLowerCase().includes(t)||s.receipt_number?.toLowerCase().includes(t))}return d.value&&(i=i.filter(t=>t.category===d.value)),o.value&&(i=i.filter(t=>t.payment_method===o.value)),r.value&&(i=i.filter(t=>t.expense_date>=r.value)),c.value&&(i=i.filter(t=>t.expense_date<=c.value)),i}),y=i=>new Intl.NumberFormat("fr-FR").format(i)+" Fcfa",C=(i,t)=>i.length>t?i.substring(0,t)+"...":i,x=()=>{},A=()=>{v.value="",d.value="",o.value="",r.value="",c.value=""},D=async i=>{await g(`Êtes-vous sûr de vouloir supprimer la dépense "${i.title}" ?`)&&Z.delete(F("expenses.destroy",{id:i.id}),{onSuccess:()=>{u(`Dépense "${i.title}" supprimée avec succès !`)},onError:s=>{const h=s.message||"Erreur lors de la suppression de la dépense.";p(h)}})};return(i,t)=>(f(),O(ee,null,{default:L(()=>[e("div",ge,[t[7]||(t[7]=e("div",null,[e("h1",{class:"h2 mb-1"},[e("i",{class:"bi bi-receipt me-2"}),U(" Gestion des dépenses ")]),e("p",{class:"text-muted mb-0"},"Suivez et gérez toutes vos dépenses")],-1)),j(m(S),{href:m(F)("expenses.create"),class:"btn btn-primary"},{default:L(()=>[...t[6]||(t[6]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),U(" Nouvelle dépense ",-1)])]),_:1},8,["href"])]),e("div",_e,[e("div",ye,[e("div",xe,[e("div",Ce,[e("div",we,[e("div",null,[t[8]||(t[8]=e("h6",{class:"card-title"},"Total dépenses",-1)),e("h4",Te,a(y(_.value)),1)]),t[9]||(t[9]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-currency-exchange fs-1"})],-1))])])])]),e("div",ke,[e("div",Me,[e("div",Ee,[e("div",Ie,[e("div",null,[e("h6",Ne,"Ce mois ("+a(V.value)+")",1),e("h4",Le,a(y(T.value)),1)]),t[10]||(t[10]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-calendar-month fs-1"})],-1))])])])]),e("div",Se,[e("div",Fe,[e("div",Ve,[e("div",Ae,[e("div",null,[t[11]||(t[11]=e("h6",{class:"card-title"},"Cette semaine",-1)),e("h4",De,a(y(k.value)),1)]),t[12]||(t[12]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-calendar-week fs-1"})],-1))])])])]),e("div",je,[e("div",Ue,[e("div",Be,[e("div",We,[e("div",null,[t[13]||(t[13]=e("h6",{class:"card-title"},"Nombre total",-1)),e("h4",$e,a(n.expenses.meta?.total||n.expenses.data.length),1)]),t[14]||(t[14]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-list-ul fs-1"})],-1))])])])])]),e("div",He,[e("div",Oe,[e("div",Re,[e("div",qe,[t[15]||(t[15]=e("label",{class:"form-label"},"Rechercher",-1)),I(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),type:"text",class:"form-control",placeholder:"Titre, description...",onInput:t[1]||(t[1]=(...s)=>m(w)&&m(w)(...s))},null,544),[[B,v.value]])]),e("div",ze,[t[17]||(t[17]=e("label",{class:"form-label"},"Catégorie",-1)),I(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),class:"form-select",onChange:x},[...t[16]||(t[16]=[e("option",{value:""},"Toutes les catégories",-1),e("option",{value:"fournitures"},"Fournitures",-1),e("option",{value:"equipement"},"Équipement",-1),e("option",{value:"marketing"},"Marketing",-1),e("option",{value:"transport"},"Transport",-1),e("option",{value:"formation"},"Formation",-1),e("option",{value:"maintenance"},"Maintenance",-1),e("option",{value:"utilities"},"Services publics",-1),e("option",{value:"autres"},"Autres",-1)])],544),[[q,d.value]])]),e("div",Ge,[t[19]||(t[19]=e("label",{class:"form-label"},"Méthode de paiement",-1)),I(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value=s),class:"form-select",onChange:x},[...t[18]||(t[18]=[e("option",{value:""},"Toutes les méthodes",-1),e("option",{value:"cash"},"Espèces",-1),e("option",{value:"bank_transfer"},"Virement bancaire",-1),e("option",{value:"credit_card"},"Carte de crédit",-1),e("option",{value:"mobile_money"},"Mobile Money",-1),e("option",{value:"orange_money"},"Orange Money",-1),e("option",{value:"wave"},"Wave",-1),e("option",{value:"check"},"Chèque",-1)])],544),[[q,o.value]])]),e("div",Pe,[t[20]||(t[20]=e("label",{class:"form-label"},"Date de début",-1)),I(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value=s),type:"date",class:"form-control",onChange:x},null,544),[[B,r.value]])]),e("div",Qe,[t[21]||(t[21]=e("label",{class:"form-label"},"Date de fin",-1)),I(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>c.value=s),type:"date",class:"form-control",onChange:x},null,544),[[B,c.value]])]),e("div",{class:"col-md-1 d-flex align-items-end"},[e("button",{onClick:A,class:"btn btn-outline-secondary",title:"Effacer les filtres"},[...t[22]||(t[22]=[e("i",{class:"bi bi-x-circle"},null,-1)])])])])])]),e("div",Xe,[t[28]||(t[28]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},[e("i",{class:"bi bi-list-ul me-2"}),U(" Liste des dépenses ")])],-1)),e("div",Je,[N.value.length===0?(f(),b("div",Ke,[...t[23]||(t[23]=[e("i",{class:"bi bi-receipt fs-1 text-muted"},null,-1),e("p",{class:"text-muted mt-3"},"Aucune dépense trouvée",-1)])])):(f(),b("div",Ye,[e("table",Ze,[t[27]||(t[27]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Numéro"),e("th",null,"Titre"),e("th",null,"Catégorie"),e("th",null,"Montant"),e("th",null,"Méthode de paiement"),e("th",null,"Date"),e("th",null,"Créé par"),e("th",null,"Actions")])],-1)),e("tbody",null,[(f(!0),b(z,null,G(N.value,s=>(f(),b("tr",{key:s.id},[e("td",null,[e("span",et,a(s.expense_number),1)]),e("td",null,[e("div",tt,a(s.title),1),s.description?(f(),b("div",st,a(C(s.description,50)),1)):R("",!0)]),e("td",null,[e("span",nt,a(s.category_label),1)]),e("td",null,[e("span",it,a(y(s.amount)),1)]),e("td",null,[e("span",lt,a(s.payment_method_label),1)]),e("td",null,[e("div",null,a(m(ne)(s.expense_date)),1),e("div",ot,a(m(ie)(s.created_at)),1)]),e("td",null,[e("div",at,[e("div",rt,a(s.user.name.charAt(0).toUpperCase()),1),e("div",null,[e("div",dt,a(s.user.name),1)])])]),e("td",null,[e("div",ut,[j(m(S),{href:m(F)("expenses.show",{id:s.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:L(()=>[...t[24]||(t[24]=[e("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),j(m(S),{href:m(F)("expenses.edit",{id:s.id}),class:"btn btn-sm btn-outline-warning",title:"Modifier"},{default:L(()=>[...t[25]||(t[25]=[e("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"]),e("button",{onClick:h=>D(s),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...t[26]||(t[26]=[e("i",{class:"bi bi-trash"},null,-1)])],8,ct)])])]))),128))])])]))])]),n.expenses.links?(f(),b("div",mt,[e("nav",null,[e("ul",ft,[(f(!0),b(z,null,G(n.expenses.links,s=>(f(),b("li",{key:s.label,class:Y(["page-item",{active:s.active,disabled:!s.url}])},[s.url?(f(),O(m(S),{key:0,href:s.url,class:"page-link",innerHTML:s.label},null,8,["href","innerHTML"])):(f(),b("span",{key:1,class:"page-link",innerHTML:s.label},null,8,vt))],2))),128))])])])):R("",!0)]),_:1}))}}),wt=le(bt,[["__scopeId","data-v-5c7b8f3f"]]);export{wt as default};
