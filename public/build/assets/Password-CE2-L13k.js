import{d as B,x as N,B as $,h as E,c as F,w as h,j as _,u as o,L as O,a as e,m as f,b as n,e as b,O as v,S as y,v as A,o as d,t as p,f as U}from"./app-DQWaqSr_.js";import{_ as D}from"./AppLayout.vue_vue_type_script_setup_true_lang-BZ-gD5FF.js";import{S as T,_ as z}from"./Layout-Bbcxr1Cy.js";import{e as I}from"./index-BA3WRlAQ.js";import{c as R,a as g,b as G,u as H}from"./index.esm-wfoc3WGD.js";import{u as J}from"./useSweetAlert-CjcY7Pj8.js";import{r as K}from"./routes-C8N3XD_S.js";import"./BootstrapLayout-CnHsE3D3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CMWG4mbA.js";import"./index-DnLC8ybD.js";import"./index-CKv6rp-i.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const Q={class:"row g-4"},W={class:"col-12"},X={class:"card"},Y={class:"card-body"},Z={class:"row g-3"},ss={class:"col-12"},os={key:0,class:"invalid-feedback d-block"},as={class:"col-12"},es={key:0,class:"invalid-feedback d-block"},rs={class:"col-12"},ts={key:0,class:"invalid-feedback d-block"},is={class:"col-12"},ds=["disabled"],ns={key:0,class:"spinner-border spinner-border-sm me-2"},ps={key:1,class:"bi bi-key me-1"},Ms=B({__name:"Password",setup(cs){const M=[{title:"Paramètres du mot de passe",href:I().url}],{success:S}=J(),V=N(),q=R({current_password:g().required("Le mot de passe actuel est requis"),password:g().required("Le nouveau mot de passe est requis").min(8,"Le mot de passe doit contenir au moins 8 caractères"),password_confirmation:g().required("La confirmation du mot de passe est requise").oneOf([G("password")],"Les mots de passe ne correspondent pas")}),{handleSubmit:L,defineField:c,errors:t,resetForm:P,isSubmitting:l,setFieldError:i}=H({validationSchema:q,initialValues:{current_password:"",password:"",password_confirmation:""}}),[u,j]=c("current_password"),[m,x]=c("password"),[w,C]=c("password_confirmation");$(()=>V.props.errors,a=>{if(a&&Object.keys(a).length>0){if(a.current_password){const s=Array.isArray(a.current_password)?a.current_password[0]:a.current_password;i("current_password",s)}if(a.password){const s=Array.isArray(a.password)?a.password[0]:a.password;i("password",s)}if(a.password_confirmation){const s=Array.isArray(a.password_confirmation)?a.password_confirmation[0]:a.password_confirmation;i("password_confirmation",s)}}},{deep:!0});const k=L(a=>{E.put(K("password.update"),a,{preserveScroll:!0,onSuccess:()=>{S("Mot de passe mis à jour avec succès."),P()},onError:s=>{if(s.current_password){const r=Array.isArray(s.current_password)?s.current_password[0]:s.current_password;i("current_password",r)}if(s.password){const r=Array.isArray(s.password)?s.password[0]:s.password;i("password",r)}if(s.password_confirmation){const r=Array.isArray(s.password_confirmation)?s.password_confirmation[0]:s.password_confirmation;i("password_confirmation",r)}}})});return(a,s)=>(d(),F(D,{breadcrumbs:M},{default:h(()=>[_(o(O),{title:"Paramètres du mot de passe"}),_(T,null,{default:h(()=>[e("div",Q,[e("div",W,[_(z,{title:"Mettre à jour le mot de passe",description:"Assurez-vous que votre compte utilise un mot de passe long et aléatoire pour rester sécurisé"}),e("form",{onSubmit:s[3]||(s[3]=(...r)=>o(k)&&o(k)(...r))},[e("div",X,[e("div",Y,[e("div",Z,[e("div",ss,[s[4]||(s[4]=e("label",{for:"current_password",class:"form-label"},"Mot de passe actuel",-1)),f(e("input",v({id:"current_password","onUpdate:modelValue":s[0]||(s[0]=r=>y(u)?u.value=r:null)},o(j),{type:"password",class:["form-control",{"is-invalid":o(t).current_password}],autocomplete:"current-password"}),null,16),[[A,o(u)]]),o(t).current_password?(d(),n("div",os,p(o(t).current_password),1)):b("",!0)]),e("div",as,[s[5]||(s[5]=e("label",{for:"password",class:"form-label"},"Nouveau mot de passe",-1)),f(e("input",v({id:"password","onUpdate:modelValue":s[1]||(s[1]=r=>y(m)?m.value=r:null)},o(x),{type:"password",class:["form-control",{"is-invalid":o(t).password}],autocomplete:"new-password"}),null,16),[[A,o(m)]]),o(t).password?(d(),n("div",es,p(o(t).password),1)):b("",!0)]),e("div",rs,[s[6]||(s[6]=e("label",{for:"password_confirmation",class:"form-label"},"Confirmer le nouveau mot de passe",-1)),f(e("input",v({id:"password_confirmation","onUpdate:modelValue":s[2]||(s[2]=r=>y(w)?w.value=r:null)},o(C),{type:"password",class:["form-control",{"is-invalid":o(t).password_confirmation}],autocomplete:"new-password"}),null,16),[[A,o(w)]]),o(t).password_confirmation?(d(),n("div",ts,p(o(t).password_confirmation),1)):b("",!0)]),e("div",is,[e("button",{type:"submit",class:"btn btn-primary",disabled:o(l)},[o(l)?(d(),n("span",ns)):(d(),n("i",ps)),U(" "+p(o(l)?"Mise à jour...":"Mettre à jour le mot de passe"),1)],8,ds)])])])])],32)])])]),_:1})]),_:1}))}});export{Ms as default};
