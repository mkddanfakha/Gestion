import{d as E,r as $,y as A,c as p,w as m,a as s,j as N,f as d,u as r,l as b,t as i,m as C,v as I,p as H,b as n,e as f,o,F as B,g as S,n as L,h as y}from"./app-DQWaqSr_.js";import{_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-BZ-gD5FF.js";import{r as u}from"./routes-C8N3XD_S.js";import{u as z}from"./useSweetAlert-CjcY7Pj8.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BootstrapLayout-CnHsE3D3.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const G={class:"d-flex justify-content-between align-items-center mb-4"},q={class:"row mb-4"},J={class:"col-md-4"},K={class:"card bg-success text-white"},O={class:"card-body"},P={class:"d-flex justify-content-between"},Q={class:"mb-0"},W={class:"col-md-4"},X={class:"card bg-info text-white"},Y={class:"card-body"},Z={class:"d-flex justify-content-between"},ss={class:"mb-0"},es={class:"col-md-4"},ts={class:"card bg-primary text-white"},ls={class:"card-body"},is={class:"d-flex justify-content-between"},os={class:"mb-0"},ns={class:"card mb-4"},as={class:"card-body"},ds={class:"row g-3"},rs={class:"col-md-4"},cs={class:"col-md-3"},us={class:"card"},vs={class:"table-responsive"},ms={class:"table table-hover mb-0"},bs={class:"text-dark"},fs={class:"d-flex align-items-center"},_s={class:"fw-medium"},ps={class:"small"},ys={class:"fw-medium"},gs={key:0,class:"text-info"},hs={key:1,class:"text-muted"},xs={class:"fw-medium text-success"},ws={class:"badge bg-light text-dark"},ks={class:"text-end"},Ns={class:"btn-group",role:"group"},Cs=["onClick"],Bs=["onClick"],Ss={key:0,class:"card-footer"},Ls={class:"d-flex justify-content-between align-items-center"},Ms={class:"d-none d-md-block"},js={class:"text-muted mb-0"},Fs={class:"fw-medium"},Vs={class:"fw-medium"},Ds={class:"fw-medium"},Ts={class:"pagination pagination-sm mb-0"},Es=["innerHTML"],$s=E({__name:"Index",props:{deliveryNotes:{},filters:{},statistics:{}},setup(a){const g=a,{success:h,error:x,confirm:w}=z(),c=$({...g.filters}),M=A(()=>g.deliveryNotes.data.filter(l=>l.status==="validated").length),k=l=>new Intl.NumberFormat("fr-FR").format(l)+" Fcfa",j=l=>new Date(l).toLocaleDateString("fr-FR"),F=l=>({pending:"bg-warning",validated:"bg-success",cancelled:"bg-danger"})[l]||"bg-secondary",_=()=>{y.get(u("delivery-notes.index"),c.value,{preserveState:!0,replace:!0})},V=()=>{c.value={},_()},D=async l=>{await w(`Êtes-vous sûr de vouloir valider le bon de livraison "${l.delivery_number}" ? Le stock sera ajusté.`)&&y.post(u("delivery-notes.validate",{id:l.id}),{},{onSuccess:()=>{h(`Bon de livraison "${l.delivery_number}" validé et stock ajusté avec succès !`)},onError:t=>{const v=t.message||"Erreur lors de la validation du bon de livraison.";x(v)}})},T=async l=>{await w(`Êtes-vous sûr de vouloir supprimer le bon de livraison "${l.delivery_number}" ?`)&&y.delete(u("delivery-notes.destroy",{id:l.id}),{onSuccess:()=>{h(`Bon de livraison "${l.delivery_number}" supprimé avec succès !`)},onError:t=>{const v=t.message||"Erreur lors de la suppression du bon de livraison.";x(v)}})};return(l,e)=>(o(),p(R,null,{default:m(()=>[s("div",G,[e[3]||(e[3]=s("div",null,[s("h1",{class:"h2 mb-1"},[s("i",{class:"bi bi-clipboard-check me-2"}),d(" Bons de livraison ")]),s("p",{class:"text-muted mb-0"},"Gérez vos bons de livraison fournisseurs")],-1)),N(r(b),{href:r(u)("delivery-notes.create"),class:"btn btn-primary"},{default:m(()=>[...e[2]||(e[2]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),d(" Nouveau bon de livraison ",-1)])]),_:1},8,["href"])]),s("div",q,[s("div",J,[s("div",K,[s("div",O,[s("div",P,[s("div",null,[e[4]||(e[4]=s("h6",{class:"card-title"},"Total BL validés",-1)),s("h4",Q,i(k(a.statistics.total_validated_amount)),1)]),e[5]||(e[5]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-check-circle fs-1"})],-1))])])])]),s("div",W,[s("div",X,[s("div",Y,[s("div",Z,[s("div",null,[e[6]||(e[6]=s("h6",{class:"card-title"},"Nombre total",-1)),s("h4",ss,i(a.deliveryNotes.total),1)]),e[7]||(e[7]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-clipboard-data fs-1"})],-1))])])])]),s("div",es,[s("div",ts,[s("div",ls,[s("div",is,[s("div",null,[e[8]||(e[8]=s("h6",{class:"card-title"},"BL validés",-1)),s("h4",os,i(M.value),1)]),e[9]||(e[9]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-clipboard-check fs-1"})],-1))])])])])]),s("div",ns,[s("div",as,[s("div",ds,[s("div",rs,[e[10]||(e[10]=s("label",{class:"form-label"},"Recherche",-1)),C(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>c.value.search=t),type:"text",placeholder:"Numéro de BL ou fournisseur...",class:"form-control",onInput:_},null,544),[[I,c.value.search]])]),s("div",cs,[e[12]||(e[12]=s("label",{class:"form-label"},"Statut",-1)),C(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.value.status=t),class:"form-select",onChange:_},[...e[11]||(e[11]=[s("option",{value:""},"Tous les statuts",-1),s("option",{value:"pending"},"En attente",-1),s("option",{value:"validated"},"Validé",-1),s("option",{value:"cancelled"},"Annulé",-1)])],544),[[H,c.value.status]])]),s("div",{class:"col-md-2 d-flex align-items-end"},[s("button",{onClick:V,class:"btn btn-outline-secondary w-100"},[...e[13]||(e[13]=[s("i",{class:"bi bi-x-circle me-1"},null,-1),d(" Effacer ",-1)])])])])])]),s("div",us,[s("div",vs,[s("table",ms,[e[19]||(e[19]=s("thead",{class:"table-light"},[s("tr",null,[s("th",null,"Numéro"),s("th",null,"Fournisseur"),s("th",null,"Date de livraison"),s("th",null,"Facture"),s("th",null,"Montant total"),s("th",null,"Articles"),s("th",null,"Statut"),s("th",{class:"text-end"},"Actions")])],-1)),s("tbody",null,[(o(!0),n(B,null,S(a.deliveryNotes.data,t=>(o(),n("tr",{key:t.id},[s("td",null,[s("code",bs,i(t.delivery_number),1)]),s("td",null,[s("div",fs,[e[14]||(e[14]=s("div",{class:"flex-shrink-0 me-2"},[s("div",{class:"bg-light rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"}},[s("i",{class:"bi bi-truck text-muted"})])],-1)),s("div",null,[s("div",_s,i(t.supplier?.name||"N/A"),1)])])]),s("td",null,[s("div",ps,[s("div",ys,i(j(t.delivery_date)),1)])]),s("td",null,[t.invoice_number?(o(),n("code",gs,i(t.invoice_number),1)):(o(),n("span",hs,"-"))]),s("td",null,[s("div",xs,i(k(t.total_amount)),1)]),s("td",null,[s("span",ws,i(t.items?.length||0)+" article(s)",1)]),s("td",null,[s("span",{class:L(["badge",F(t.status)])},i(t.status_label),3)]),s("td",ks,[s("div",Ns,[N(r(b),{href:r(u)("delivery-notes.show",{id:t.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:m(()=>[...e[15]||(e[15]=[s("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),t.status==="pending"?(o(),p(r(b),{key:0,href:r(u)("delivery-notes.edit",{id:t.id}),class:"btn btn-sm btn-outline-warning",title:"Modifier"},{default:m(()=>[...e[16]||(e[16]=[s("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"])):f("",!0),t.status==="pending"?(o(),n("button",{key:1,onClick:v=>D(t),class:"btn btn-sm btn-outline-success",title:"Valider"},[...e[17]||(e[17]=[s("i",{class:"bi bi-check-circle"},null,-1)])],8,Cs)):f("",!0),t.status==="pending"?(o(),n("button",{key:2,onClick:v=>T(t),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...e[18]||(e[18]=[s("i",{class:"bi bi-trash"},null,-1)])],8,Bs)):f("",!0)])])]))),128))])])]),a.deliveryNotes.links?(o(),n("div",Ss,[s("div",Ls,[s("div",Ms,[s("p",js,[e[20]||(e[20]=d(" Affichage de ",-1)),s("span",Fs,i(a.deliveryNotes.from),1),e[21]||(e[21]=d(" à ",-1)),s("span",Vs,i(a.deliveryNotes.to),1),e[22]||(e[22]=d(" sur ",-1)),s("span",Ds,i(a.deliveryNotes.total),1),e[23]||(e[23]=d(" résultats ",-1))])]),s("nav",null,[s("ul",Ts,[(o(!0),n(B,null,S(a.deliveryNotes.links,t=>(o(),n("li",{key:t.label,class:L(["page-item",{active:t.active,disabled:!t.url}])},[t.url?(o(),p(r(b),{key:0,href:t.url,class:"page-link",innerHTML:t.label},null,8,["href","innerHTML"])):(o(),n("span",{key:1,class:"page-link",innerHTML:t.label},null,8,Es))],2))),128))])])])])):f("",!0)])]),_:1}))}}),qs=U($s,[["__scopeId","data-v-1095e7e4"]]);export{qs as default};
