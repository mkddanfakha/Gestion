import{d as U,r as z,z as q,B as F,c as w,w as f,a as e,j as h,f as o,u as d,l as p,m as v,b as r,e as y,v as g,o as i,F as C,g as M,t as a,n as x,h as S}from"./app-DQWaqSr_.js";import{_ as O}from"./AppLayout.vue_vue_type_script_setup_true_lang-BZ-gD5FF.js";import{r as b}from"./routes-C8N3XD_S.js";import{u as R}from"./useSweetAlert-CjcY7Pj8.js";import{f as G,a as W}from"./BootstrapLayout-CnHsE3D3.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const K={class:"d-flex justify-content-between align-items-center mb-4"},Q={class:"card mb-4"},X={class:"card-body"},Y={class:"row g-3"},Z={class:"col-md-3"},ee={class:"input-group"},te={class:"col-md-2"},se={class:"col-md-2"},le={class:"col-md-2"},ne={class:"input-group"},ae={class:"card"},ie={class:"table-responsive"},oe={class:"table table-hover mb-0"},de={class:"text-dark"},re={class:"d-flex align-items-center"},ue={class:"fw-medium"},ce={class:"text-muted small"},me={class:"small"},be={class:"fw-medium"},fe={class:"text-muted"},pe={class:"fw-medium text-success"},ve={class:"d-flex align-items-center"},ge={class:"fw-medium"},_e={class:"badge bg-light text-dark"},he={class:"text-end"},ye={class:"btn-group",role:"group"},xe=["onClick"],ke={key:0,class:"card-footer"},we={class:"d-flex justify-content-between align-items-center"},Ce={class:"d-none d-md-block"},Me={class:"text-muted mb-0"},Se={class:"fw-medium"},Ve={class:"fw-medium"},Te={class:"fw-medium"},De={class:"pagination pagination-sm mb-0"},Ee=["innerHTML"],Ne=U({__name:"Index",props:{sales:{},filters:{}},setup(u){const m=u,{success:V,error:T,confirm:D}=R(),n=z({...m.filters});q(()=>{m.filters&&(n.value={...n.value,...m.filters})}),F(()=>m.filters,l=>{l&&Object.keys(l).forEach(t=>{l[t]!==void 0&&l[t]!==null&&l[t]!==""&&(n.value[t]=l[t])})},{deep:!0,immediate:!0});const E=l=>new Intl.NumberFormat("fr-FR").format(l)+" Fcfa",N=l=>({cash:"Espèces",card:"Carte",bank_transfer:"Virement bancaire",check:"Chèque",orange_money:"Orange Money",wave:"Wave"})[l]||l,j=l=>({paid:"Payé",partial:"Paiement partiel",pending:"En attente"})[l]||l,I=l=>({paid:"bg-success",partial:"bg-warning text-dark",pending:"bg-danger"})[l]||"bg-secondary",L=l=>({paid:"bi bi-check-circle",partial:"bi bi-clock",pending:"bi bi-exclamation-circle"})[l]||"bi bi-question-circle",c=()=>{S.get(b("sales.index"),n.value,{preserveState:!0,replace:!0})};let _=null;const P=()=>{_&&clearTimeout(_),_=setTimeout(()=>{c()},500)},B=()=>{n.value={},c()},$=()=>{n.value.search="",c()},A=()=>{n.value.due_date=void 0,c()},H=async l=>{await D(`Êtes-vous sûr de vouloir supprimer la vente "${l.sale_number}" ?`)&&S.delete(b("sales.destroy",{id:l.id}),{onSuccess:()=>{V(`Vente "${l.sale_number}" supprimée avec succès !`)},onError:s=>{const k=s.message||"Erreur lors de la suppression de la vente.";T(k)}})};return(l,t)=>(i(),w(O,null,{default:f(()=>[e("div",K,[t[5]||(t[5]=e("div",null,[e("h1",{class:"h2 mb-1"},[e("i",{class:"bi bi-cart-check me-2"}),o(" Ventes ")]),e("p",{class:"text-muted mb-0"},"Gérez vos ventes et transactions")],-1)),h(d(p),{href:d(b)("sales.create"),class:"btn btn-success"},{default:f(()=>[...t[4]||(t[4]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),o(" Nouvelle vente ",-1)])]),_:1},8,["href"])]),e("div",Q,[e("div",X,[e("div",Y,[e("div",Z,[t[8]||(t[8]=e("label",{class:"form-label"},"Recherche",-1)),e("div",ee,[t[7]||(t[7]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),v(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.value.search=s),type:"text",placeholder:"Nom client ou numéro de vente...",class:"form-control",onInput:P},null,544),[[g,n.value.search]]),n.value.search?(i(),r("button",{key:0,onClick:$,class:"btn btn-outline-secondary",type:"button"},[...t[6]||(t[6]=[e("i",{class:"bi bi-x"},null,-1)])])):y("",!0)])]),e("div",te,[t[9]||(t[9]=e("label",{class:"form-label"},"Date de début",-1)),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.value.date_from=s),type:"date",class:"form-control",onChange:c},null,544),[[g,n.value.date_from]])]),e("div",se,[t[10]||(t[10]=e("label",{class:"form-label"},"Date de fin",-1)),v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.date_to=s),type:"date",class:"form-control",onChange:c},null,544),[[g,n.value.date_to]])]),e("div",le,[t[13]||(t[13]=e("label",{class:"form-label"},"Date d'échéance",-1)),e("div",ne,[t[12]||(t[12]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-calendar-event"})],-1)),v((i(),r("input",{key:`due-date-${m.filters.due_date||n.value.due_date||"empty"}`,"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.due_date=s),type:"date",class:"form-control",onChange:c},null,32)),[[g,n.value.due_date]]),n.value.due_date?(i(),r("button",{key:0,onClick:A,class:"btn btn-outline-secondary",type:"button",title:"Effacer le filtre de date d'échéance"},[...t[11]||(t[11]=[e("i",{class:"bi bi-x"},null,-1)])])):y("",!0)])]),e("div",{class:"col-md-1 d-flex align-items-end"},[e("button",{onClick:B,class:"btn btn-outline-secondary w-100"},[...t[14]||(t[14]=[e("i",{class:"bi bi-x-circle me-1"},null,-1),o(" Effacer ",-1)])])])])])]),e("div",ae,[e("div",ie,[e("table",oe,[t[22]||(t[22]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Numéro"),e("th",null,"Client"),e("th",null,"Date"),e("th",null,"Montant"),e("th",null,"Articles"),e("th",null,"Méthode de paiement"),e("th",null,"Statut"),e("th",{class:"text-end"},"Actions")])],-1)),e("tbody",null,[(i(!0),r(C,null,M(u.sales.data,s=>(i(),r("tr",{key:s.id},[e("td",null,[e("code",de,a(s.sale_number),1)]),e("td",null,[e("div",re,[t[15]||(t[15]=e("div",{class:"flex-shrink-0 me-2"},[e("div",{class:"bg-light rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"}},[e("i",{class:"bi bi-person text-muted"})])],-1)),e("div",null,[e("div",ue,a(s.customer?.name||"Client anonyme"),1),e("div",ce,a(s.customer?.email||""),1)])])]),e("td",null,[e("div",me,[e("div",be,a(d(G)(s.created_at)),1),e("div",fe,a(d(W)(s.created_at)),1)])]),e("td",null,[e("div",pe,a(E(s.total_amount)),1)]),e("td",null,[e("div",ve,[t[16]||(t[16]=e("div",{class:"bg-light rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"24px",height:"24px"}},[e("i",{class:"bi bi-box text-muted small"})],-1)),e("span",ge,a(s.items_count||0),1),t[17]||(t[17]=e("span",{class:"text-muted ms-1 small"},"article(s)",-1))])]),e("td",null,[e("span",_e,[t[18]||(t[18]=e("i",{class:"bi bi-credit-card me-1"},null,-1)),o(" "+a(N(s.payment_method)),1)])]),e("td",null,[e("span",{class:x(["badge",I(s.payment_status||"paid")])},[e("i",{class:x(["me-1",L(s.payment_status||"paid")])},null,2),o(" "+a(j(s.payment_status||"paid")),1)],2)]),e("td",he,[e("div",ye,[h(d(p),{href:d(b)("sales.show",{id:s.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:f(()=>[...t[19]||(t[19]=[e("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),h(d(p),{href:d(b)("sales.edit",{id:s.id}),class:"btn btn-sm btn-outline-secondary",title:"Modifier"},{default:f(()=>[...t[20]||(t[20]=[e("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"]),e("button",{onClick:k=>H(s),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...t[21]||(t[21]=[e("i",{class:"bi bi-trash"},null,-1)])],8,xe)])])]))),128))])])]),u.sales.links?(i(),r("div",ke,[e("div",we,[e("div",Ce,[e("p",Me,[t[23]||(t[23]=o(" Affichage de ",-1)),e("span",Se,a(u.sales.from),1),t[24]||(t[24]=o(" à ",-1)),e("span",Ve,a(u.sales.to),1),t[25]||(t[25]=o(" sur ",-1)),e("span",Te,a(u.sales.total),1),t[26]||(t[26]=o(" résultats ",-1))])]),e("nav",null,[e("ul",De,[(i(!0),r(C,null,M(u.sales.links,s=>(i(),r("li",{key:s.label,class:x(["page-item",{active:s.active,disabled:!s.url}])},[s.url?(i(),w(d(p),{key:0,href:s.url,class:"page-link",innerHTML:s.label},null,8,["href","innerHTML"])):(i(),r("span",{key:1,class:"page-link",innerHTML:s.label},null,8,Ee))],2))),128))])])])])):y("",!0)])]),_:1}))}}),He=J(Ne,[["__scopeId","data-v-a481e26c"]]);export{He as default};
