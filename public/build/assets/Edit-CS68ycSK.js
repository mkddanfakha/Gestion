import{d as yt,r as C,i as gt,y as S,B as A,c as kt,w as B,a as e,j as T,t as d,u as o,l as Y,f as V,b as i,e as r,o as l,m as b,n as q,p as xt,v as k,F as wt,g as ht,s as Z,L as $}from"./app-DG1zKyXK.js";import{_ as Ft}from"./AppLayout.vue_vue_type_script_setup_true_lang-BeGZtpnK.js";import{r as I}from"./routes-C8N3XD_S.js";import{u as St}from"./useSweetAlert-CjcY7Pj8.js";import{P as Vt}from"./ProductAutocomplete-DSGgwAoE.js";import{C as qt}from"./CustomerAutocomplete-bMaSh0h8.js";import{_ as Mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BootstrapLayout-BOh8Ux6F.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const Pt={class:"d-flex justify-content-between align-items-center mb-4"},Ct={class:"h2 mb-1"},At={class:"row"},Ut={class:"col-lg-8"},It={class:"card mb-4"},Nt={class:"card-body"},Lt={class:"row g-3"},jt={class:"col-md-6"},Et={key:0,class:"invalid-feedback d-block"},Dt={class:"col-md-6"},Wt={key:0,class:"invalid-feedback"},Tt={key:1,class:"invalid-feedback"},$t={class:"col-md-6"},Rt={key:0,class:"invalid-feedback"},zt={class:"mt-3"},Bt={key:0,class:"invalid-feedback"},Ot={class:"card mb-4"},Qt={class:"card-header d-flex justify-content-between align-items-center"},Gt={class:"d-flex gap-2"},Ht={class:"card-body"},Jt={key:0,class:"text-center py-4 text-muted"},Kt={key:1},Xt={class:"row g-3"},Yt={class:"col-md-4"},Zt={key:0,class:"invalid-feedback d-block"},te={class:"col-md-2"},ee=["onUpdate:modelValue","max","onInput"],ne={key:0,class:"invalid-feedback"},ae={key:1,class:"form-text text-muted"},se={class:"col-md-2"},oe={class:"input-group"},le=["onUpdate:modelValue","onInput"],ie={class:"col-md-2"},ue={class:"input-group"},de=["onUpdate:modelValue"],re={class:"col-md-2 d-flex align-items-end"},me=["onClick"],ce={class:"col-lg-4"},pe={class:"card"},ve={class:"card-body"},_e={class:"d-flex justify-content-between mb-2"},fe={class:"fw-medium"},be={class:"d-flex justify-content-between mb-2"},ye={class:"fw-medium"},ge={class:"mb-3"},ke={class:"btn-group w-100 mb-2",role:"group"},xe={key:0,class:"input-group"},we={key:1,class:"input-group"},he={key:2,class:"small text-muted mt-1"},Fe={key:3,class:"invalid-feedback"},Se={key:4,class:"invalid-feedback"},Ve={class:"mb-3"},qe={class:"btn-group w-100 mb-2",role:"group"},Me={key:0,class:"input-group"},Pe={key:1,class:"input-group"},Ce={key:2,class:"small text-muted mt-1"},Ae={key:3,class:"invalid-feedback"},Ue={key:4,class:"invalid-feedback"},Ie={class:"mb-3"},Ne={class:"input-group"},Le=["max"],je={key:0,class:"invalid-feedback"},Ee={key:1,class:"invalid-feedback"},De={class:"form-text text-muted"},We={key:0,class:"mb-3"},Te={class:"input-group"},$e=["disabled"],Re={key:0,class:"invalid-feedback d-block"},ze={key:1,class:"form-text text-muted"},Be={key:2,class:"form-text text-muted"},Oe={class:"d-flex justify-content-between mb-2"},Qe={class:"fw-bold text-success fs-5"},Ge={key:1,class:"d-flex justify-content-between mb-2"},He={class:"fw-medium text-primary"},Je={key:2,class:"d-flex justify-content-between mb-2"},Ke={class:"fw-bold text-warning fs-5"},Xe={key:3,class:"d-flex justify-content-between mb-3 p-2 bg-light rounded"},Ye={class:"fw-bold text-info fs-5"},Ze={class:"d-grid gap-2"},tn=["disabled"],en={key:0,class:"spinner-border spinner-border-sm me-2"},nn={key:1,class:"bi bi-check-circle me-1"},an=["disabled"],sn=["disabled"],on=yt({__name:"Edit",props:{sale:{},customers:{},products:{}},setup(N){const c=N,{success:R,error:P,confirmWithDetails:O}=St(),p=C({}),_=C("amount"),f=C("amount"),x=C(0),w=C(0),h=C(0),a=gt({customer_id:c.sale.customer_id||"",payment_method:c.sale.payment_method,notes:c.sale.notes||"",due_date:c.sale.due_date?new Date(c.sale.due_date).toISOString().split("T")[0]:"",tax_amount:parseFloat(String(c.sale.tax_amount))||0,discount_amount:parseFloat(String(c.sale.discount_amount))||0,down_payment_amount:parseFloat(String(c.sale.down_payment_amount))||0,payment_status:c.sale.payment_status||"pending",items:c.sale.saleItems?c.sale.saleItems.map(n=>({product_id:n.product_id||0,quantity:parseInt(String(n.quantity))||1,unit_price:parseFloat(String(n.unit_price))||0,total_price:parseFloat(String(n.total_price))||0})):[]}),tt=()=>{a.items.push({product_id:0,quantity:1,unit_price:0,total_price:0})},et=n=>{a.items.splice(n,1)},nt=(n,t)=>{const s=a.items[t];s.product_id=n.id,s.unit_price=n.price,z(t)},at=n=>a.items.map((t,s)=>s!==n?t.product_id:null).filter(t=>t!==null&&t>0),z=n=>{const t=a.items[n],s=parseFloat(String(t.quantity))||0,u=parseFloat(String(t.unit_price))||0,v=s*u;t.total_price=isNaN(v)?0:v},st=(n,t)=>n?a.items.some((s,u)=>u!==t&&s.product_id===n):!1,Q=n=>{const t=a.items[n];return t.product_id?st(t.product_id,n):!1},ot=S(()=>{const n=a.items.map(t=>t.product_id).filter(t=>t>0);return n.length!==new Set(n).size}),lt=()=>{const n=new Map;a.items.forEach(t=>{if(t.product_id>0)if(n.has(t.product_id)){const s=n.get(t.product_id);s.quantity+=t.quantity,s.total_price=s.quantity*s.unit_price}else n.set(t.product_id,{...t})}),a.items=Array.from(n.values())},L=n=>{const t=a.items[n];if(!t.product_id||!t.quantity)return!1;const s=j(n);return t.quantity>s},j=n=>{const t=a.items[n];if(!t.product_id)return 0;const s=c.products.find(u=>u.id===t.product_id);return s?s.stock_quantity:0},G=n=>{const t=a.items[n];if(!t.product_id)return"";const s=c.products.find(u=>u.id===t.product_id);return s?s.unit:""},it=n=>j(n),H=n=>{if(!n||n===0||typeof n!="number"||isNaN(n))return"80px";const W=70+n.toFixed(2).length*9;return`${Math.max(70,Math.min(130,W))}px`},F=n=>{if(n==null)return"0 Fcfa";const t=parseFloat(String(n));return isNaN(t)?"0 Fcfa":new Intl.NumberFormat("fr-FR").format(t)+" Fcfa"},ut=S(()=>a.items.length),y=S(()=>{const n=a.items.reduce((t,s)=>{const u=parseFloat(String(s.quantity))||0,v=parseFloat(String(s.unit_price))||0,W=u*v;return t+(isNaN(W)?0:W)},0);return isNaN(n)?0:n}),J=S(()=>_.value==="percent"&&x.value>0?y.value*x.value/100:parseFloat(String(a.tax_amount))||0),K=S(()=>f.value==="percent"&&w.value>0?y.value*w.value/100:parseFloat(String(a.discount_amount))||0),E=()=>{_.value==="percent"&&x.value>0?a.tax_amount=y.value*x.value/100:_.value==="percent"&&(a.tax_amount=0)},D=()=>{f.value==="percent"&&w.value>0?a.discount_amount=y.value*w.value/100:f.value==="percent"&&(a.discount_amount=0)},dt=()=>{_.value==="amount"&&y.value>0&&a.tax_amount>0?x.value=a.tax_amount/y.value*100:_.value==="amount"&&(x.value=0)},rt=()=>{f.value==="amount"&&y.value>0&&a.discount_amount>0?w.value=a.discount_amount/y.value*100:f.value==="amount"&&(w.value=0)};A(_,n=>{n==="percent"?E():dt()}),A(f,n=>{n==="percent"?D():rt()}),A(()=>a.tax_amount,n=>{_.value==="amount"&&y.value>0&&n>0&&(x.value=n/y.value*100)},{immediate:!0}),A(()=>a.discount_amount,n=>{f.value==="amount"&&y.value>0&&n>0&&(w.value=n/y.value*100)},{immediate:!0}),A(y,()=>{_.value==="percent"&&E(),f.value==="percent"&&D()});const mt=S(()=>{if(_.value==="percent")return J.value;const n=parseFloat(String(a.tax_amount))||0;return isNaN(n)?0:n}),ct=S(()=>{if(f.value==="percent")return K.value;const n=parseFloat(String(a.discount_amount))||0;return isNaN(n)?0:n}),g=S(()=>{const n=y.value,t=mt.value,s=ct.value,u=n+t-s;return isNaN(u)?0:u}),M=S(()=>g.value-(a.down_payment_amount||0)),pt=S(()=>{if(a.payment_method==="cash"){const n=a.down_payment_amount>0?M.value:g.value;if(h.value>=n)return h.value-n}return 0});A([()=>a.down_payment_amount,g],()=>{const n=a.down_payment_amount||0,t=g.value||0;n>=t&&t>0?a.payment_status="paid":n>0&&t-n>0?a.payment_status="partial":n===0&&t>0&&(a.payment_status="pending")});const vt=()=>{const n={};return a.payment_method||(n.payment_method="Le mode de paiement est requis"),a.tax_amount<0&&(n.tax_amount="Le montant de la taxe ne peut pas être négatif"),a.discount_amount<0&&(n.discount_amount="Le montant de la remise ne peut pas être négatif"),a.down_payment_amount<0&&(n.down_payment_amount="L'acompte ne peut pas être négatif"),a.down_payment_amount>g.value&&(n.down_payment_amount="L'acompte ne peut pas dépasser le montant total"),a.items.forEach((t,s)=>{t.product_id||(n[`items.${s}.product_id`]="Le produit est requis"),(!t.quantity||t.quantity<1)&&(n[`items.${s}.quantity`]="La quantité doit être au moins 1"),(!t.unit_price||t.unit_price<0)&&(n[`items.${s}.unit_price`]="Le prix unitaire doit être positif"),L(s)&&(n[`items.${s}.quantity`]="La quantité dépasse le stock disponible")}),Object.keys(n).length===0?null:n},X=(n,t)=>{p.value[n]&&delete p.value[n];let s="";switch(n){case"payment_method":t||(s="Le mode de paiement est requis");break;case"tax_amount":t<0&&(s="Le montant de la taxe ne peut pas être négatif");break;case"discount_amount":t<0&&(s="Le montant de la remise ne peut pas être négatif");break;case"down_payment_amount":t<0?s="L'acompte ne peut pas être négatif":t>g.value&&(s="L'acompte ne peut pas dépasser le montant total");break}s&&(p.value[n]=s)},_t=()=>{p.value={},_.value==="percent"&&E(),f.value==="percent"&&D();const n=vt();if(n){p.value=n;return}if(a.items.length===0){P("Veuillez ajouter au moins un article.");return}if(a.payment_method==="cash"&&h.value>0){const s=a.down_payment_amount>0?M.value:g.value;if(h.value<s){P(`Le montant reçu doit être au moins égal à ${a.down_payment_amount>0?"le reste à payer":"le montant total"}.`);return}}if(a.items.some((s,u)=>L(u))){P("Veuillez corriger les quantités qui dépassent le stock disponible.");return}a.put(I("sales.update",{id:c.sale.id}),{onSuccess:()=>{R("Vente modifiée avec succès !"),p.value={}},onError:()=>{P("Erreur lors de la modification de la vente.")}})},ft=async()=>{await O("Êtes-vous sûr de vouloir marquer cette vente comme payée ?","Confirmer le paiement",`Cela va :<br>• Marquer le statut comme "payé"<br>• Définir l'acompte égal au montant total<br>• Mettre le reste à payer à 0`)&&(a.payment_status="paid",a.down_payment_amount=g.value,a.put(I("sales.update",{id:c.sale.id}),{onSuccess:()=>{R("Vente marquée comme payée avec succès !")},onError:()=>{P("Erreur lors de la mise à jour du statut de paiement."),a.payment_status=c.sale.payment_status||"pending",a.down_payment_amount=parseFloat(String(c.sale.down_payment_amount))||0}}))},bt=async()=>{await O("Êtes-vous sûr de vouloir marquer cette vente comme non payée ?","Confirmer le non-paiement",`Cela va :<br>• Marquer le statut comme "en attente"<br>• Remettre l'acompte à 0<br>• Le reste à payer sera égal au montant total`)&&(a.payment_status="pending",a.down_payment_amount=0,a.put(I("sales.update",{id:c.sale.id}),{onSuccess:()=>{R("Vente marquée comme non payée avec succès !")},onError:()=>{P("Erreur lors de la mise à jour du statut de paiement."),a.payment_status=c.sale.payment_status||"pending",a.down_payment_amount=parseFloat(String(c.sale.down_payment_amount))||0}}))},{errors:m,processing:U}=a;return(n,t)=>(l(),kt(Ft,null,{default:B(()=>[e("div",Pt,[e("div",null,[e("h1",Ct,"Modifier la vente "+d(N.sale.sale_number),1),t[16]||(t[16]=e("p",{class:"text-muted mb-0"},"Modifiez les informations de la vente",-1))]),T(o(Y),{href:o(I)("sales.index"),class:"btn btn-outline-secondary"},{default:B(()=>[...t[17]||(t[17]=[e("i",{class:"bi bi-arrow-left me-1"},null,-1),V(" Retour à la liste ",-1)])]),_:1},8,["href"])]),e("form",null,[e("div",At,[e("div",Ut,[e("div",It,[t[24]||(t[24]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},"Informations générales")],-1)),e("div",Nt,[e("div",Lt,[e("div",jt,[t[18]||(t[18]=e("label",{class:"form-label"},"Client",-1)),T(qt,{customers:N.customers,modelValue:o(a).customer_id,"onUpdate:modelValue":t[0]||(t[0]=s=>o(a).customer_id=s),placeholder:"Rechercher un client (optionnel)...","is-invalid":!!o(m).customer_id},null,8,["customers","modelValue","is-invalid"]),o(m).customer_id?(l(),i("div",Et,d(o(m).customer_id),1)):r("",!0)]),e("div",Dt,[t[20]||(t[20]=e("label",{class:"form-label"},[V(" Mode de paiement "),e("span",{class:"text-danger"},"*")],-1)),b(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(a).payment_method=s),required:"",class:q(["form-select",{"is-invalid":o(m).payment_method||p.value.payment_method}]),onBlur:t[2]||(t[2]=s=>X("payment_method",o(a).payment_method)),onChange:t[3]||(t[3]=s=>X("payment_method",o(a).payment_method))},[...t[19]||(t[19]=[e("option",{value:""},"Sélectionner un mode de paiement",-1),e("option",{value:"cash"},"Espèces",-1),e("option",{value:"card"},"Carte",-1),e("option",{value:"bank_transfer"},"Virement bancaire",-1),e("option",{value:"check"},"Chèque",-1),e("option",{value:"orange_money"},"Orange Money",-1),e("option",{value:"wave"},"Wave",-1)])],34),[[xt,o(a).payment_method]]),o(m).payment_method?(l(),i("div",Wt,d(o(m).payment_method),1)):r("",!0),p.value.payment_method?(l(),i("div",Tt,d(p.value.payment_method),1)):r("",!0)]),e("div",$t,[t[21]||(t[21]=e("label",{class:"form-label"},"Date d'échéance (optionnel)",-1)),b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o(a).due_date=s),type:"date",class:q(["form-control",{"is-invalid":o(m).due_date}])},null,2),[[k,o(a).due_date]]),o(m).due_date?(l(),i("div",Rt,d(o(m).due_date),1)):r("",!0),t[22]||(t[22]=e("small",{class:"form-text text-muted"},"Date limite de paiement",-1))])]),e("div",zt,[t[23]||(t[23]=e("label",{class:"form-label"},"Notes (optionnel)",-1)),b(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>o(a).notes=s),rows:"3",class:q(["form-control",{"is-invalid":o(m).notes}]),placeholder:"Ajoutez des notes sur cette vente..."},null,2),[[k,o(a).notes]]),o(m).notes?(l(),i("div",Bt,d(o(m).notes),1)):r("",!0)])])]),e("div",Ot,[e("div",Qt,[t[27]||(t[27]=e("h5",{class:"card-title mb-0"},"Articles",-1)),e("div",Gt,[ot.value?(l(),i("button",{key:0,type:"button",onClick:lt,class:"btn btn-warning btn-sm"},[...t[25]||(t[25]=[e("i",{class:"bi bi-arrow-down-up me-1"},null,-1),V(" Fusionner les doublons ",-1)])])):r("",!0),e("button",{type:"button",onClick:tt,class:"btn btn-primary btn-sm"},[...t[26]||(t[26]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),V(" Ajouter un article ",-1)])])])]),e("div",Ht,[o(a).items.length===0?(l(),i("div",Jt,[...t[28]||(t[28]=[e("i",{class:"bi bi-cart-x fs-1 mb-3"},null,-1),e("p",null,'Aucun article ajouté. Cliquez sur "Ajouter un article" pour commencer.',-1)])])):(l(),i("div",Kt,[(l(!0),i(wt,null,ht(o(a).items,(s,u)=>(l(),i("div",{key:u,class:"border rounded p-3 mb-3"},[e("div",Xt,[e("div",Yt,[t[29]||(t[29]=e("label",{class:"form-label"},[V(" Produit "),e("span",{class:"text-danger"},"*")],-1)),T(Vt,{modelValue:s.product_id,"onUpdate:modelValue":v=>s.product_id=v,products:N.products,"exclude-product-ids":at(u),"is-invalid":Q(u),placeholder:"Rechercher un produit...",onSelected:v=>nt(v,u)},null,8,["modelValue","onUpdate:modelValue","products","exclude-product-ids","is-invalid","onSelected"]),Q(u)?(l(),i("div",Zt," Ce produit est déjà sélectionné dans cette vente. ")):r("",!0)]),e("div",te,[t[30]||(t[30]=e("label",{class:"form-label"},[V(" Quantité "),e("span",{class:"text-danger"},"*")],-1)),b(e("input",{"onUpdate:modelValue":v=>s.quantity=v,type:"number",min:"1",max:it(u),required:"",class:q(["form-control",{"is-invalid":L(u)}]),onInput:v=>z(u)},null,42,ee),[[k,s.quantity,void 0,{number:!0}]]),L(u)?(l(),i("div",ne," Stock insuffisant. Disponible: "+d(j(u))+" "+d(G(u)),1)):s.product_id?(l(),i("div",ae," Stock disponible: "+d(j(u))+" "+d(G(u)),1)):r("",!0)]),e("div",se,[t[32]||(t[32]=e("label",{class:"form-label"},"Prix unitaire",-1)),e("div",oe,[b(e("input",{"onUpdate:modelValue":v=>s.unit_price=v,type:"number",step:"0.01",min:"0",class:"form-control",style:Z({width:H(s.unit_price)}),onInput:v=>z(u)},null,44,le),[[k,s.unit_price,void 0,{number:!0}]]),t[31]||(t[31]=e("span",{class:"input-group-text"},"Fcfa",-1))])]),e("div",ie,[t[34]||(t[34]=e("label",{class:"form-label"},"Total",-1)),e("div",ue,[b(e("input",{"onUpdate:modelValue":v=>s.total_price=v,type:"number",step:"0.01",readonly:"",class:"form-control",style:Z({width:H(s.total_price)})},null,12,de),[[k,s.total_price,void 0,{number:!0}]]),t[33]||(t[33]=e("span",{class:"input-group-text"},"Fcfa",-1))])]),e("div",re,[e("button",{type:"button",onClick:v=>et(u),class:"btn btn-outline-danger w-100"},[...t[35]||(t[35]=[e("i",{class:"bi bi-trash"},null,-1)])],8,me)])])]))),128))]))])])]),e("div",ce,[e("div",pe,[t[60]||(t[60]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},"Résumé de la vente")],-1)),e("div",ve,[e("div",_e,[t[36]||(t[36]=e("span",null,"Nombre d'articles:",-1)),e("span",fe,d(ut.value),1)]),e("div",be,[t[37]||(t[37]=e("span",null,"Sous-total:",-1)),e("span",ye,d(F(y.value)),1)]),e("div",ge,[t[42]||(t[42]=e("label",{class:"form-label"},"Taxes",-1)),e("div",ke,[b(e("input",{type:"radio",class:"btn-check",id:"tax-mode-amount-edit",value:"amount","onUpdate:modelValue":t[6]||(t[6]=s=>_.value=s)},null,512),[[$,_.value]]),t[38]||(t[38]=e("label",{class:"btn btn-outline-primary",for:"tax-mode-amount-edit"},"Montant (Fcfa)",-1)),b(e("input",{type:"radio",class:"btn-check",id:"tax-mode-percent-edit",value:"percent","onUpdate:modelValue":t[7]||(t[7]=s=>_.value=s)},null,512),[[$,_.value]]),t[39]||(t[39]=e("label",{class:"btn btn-outline-primary",for:"tax-mode-percent-edit"},"Pourcentage (%)",-1))]),_.value==="amount"?(l(),i("div",xe,[b(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=s=>o(a).tax_amount=s),step:"0.01",min:"0",class:q(["form-control",{"is-invalid":o(m).tax_amount||p.value.tax_amount}]),placeholder:"0.00"},null,2),[[k,o(a).tax_amount,void 0,{number:!0}]]),t[40]||(t[40]=e("span",{class:"input-group-text"},"Fcfa",-1))])):(l(),i("div",we,[b(e("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=s=>x.value=s),step:"0.01",min:"0",max:"100",class:"form-control",placeholder:"0.00",onInput:E},null,544),[[k,x.value,void 0,{number:!0}]]),t[41]||(t[41]=e("span",{class:"input-group-text"},"%",-1))])),_.value==="percent"&&x.value>0?(l(),i("div",he," = "+d(F(J.value)),1)):r("",!0),o(m).tax_amount?(l(),i("div",Fe,d(o(m).tax_amount),1)):r("",!0),p.value.tax_amount?(l(),i("div",Se,d(p.value.tax_amount),1)):r("",!0)]),e("div",Ve,[t[47]||(t[47]=e("label",{class:"form-label"},"Remise",-1)),e("div",qe,[b(e("input",{type:"radio",class:"btn-check",id:"discount-mode-amount-edit",value:"amount","onUpdate:modelValue":t[10]||(t[10]=s=>f.value=s)},null,512),[[$,f.value]]),t[43]||(t[43]=e("label",{class:"btn btn-outline-primary",for:"discount-mode-amount-edit"},"Montant (Fcfa)",-1)),b(e("input",{type:"radio",class:"btn-check",id:"discount-mode-percent-edit",value:"percent","onUpdate:modelValue":t[11]||(t[11]=s=>f.value=s)},null,512),[[$,f.value]]),t[44]||(t[44]=e("label",{class:"btn btn-outline-primary",for:"discount-mode-percent-edit"},"Pourcentage (%)",-1))]),f.value==="amount"?(l(),i("div",Me,[b(e("input",{type:"number","onUpdate:modelValue":t[12]||(t[12]=s=>o(a).discount_amount=s),step:"0.01",min:"0",class:q(["form-control",{"is-invalid":o(m).discount_amount||p.value.discount_amount}]),placeholder:"0.00"},null,2),[[k,o(a).discount_amount,void 0,{number:!0}]]),t[45]||(t[45]=e("span",{class:"input-group-text"},"Fcfa",-1))])):(l(),i("div",Pe,[b(e("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=s=>w.value=s),step:"0.01",min:"0",max:"100",class:"form-control",placeholder:"0.00",onInput:D},null,544),[[k,w.value,void 0,{number:!0}]]),t[46]||(t[46]=e("span",{class:"input-group-text"},"%",-1))])),f.value==="percent"&&w.value>0?(l(),i("div",Ce," = "+d(F(K.value)),1)):r("",!0),o(m).discount_amount?(l(),i("div",Ae,d(o(m).discount_amount),1)):r("",!0),p.value.discount_amount?(l(),i("div",Ue,d(p.value.discount_amount),1)):r("",!0)]),e("div",Ie,[t[49]||(t[49]=e("label",{class:"form-label"},"Acompte (Fcfa)",-1)),e("div",Ne,[b(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=s=>o(a).down_payment_amount=s),step:"0.01",min:"0",max:g.value,class:q(["form-control",{"is-invalid":o(m).down_payment_amount||p.value.down_payment_amount}]),placeholder:"0.00"},null,10,Le),[[k,o(a).down_payment_amount,void 0,{number:!0}]]),t[48]||(t[48]=e("span",{class:"input-group-text"},"Fcfa",-1))]),o(m).down_payment_amount?(l(),i("div",je,d(o(m).down_payment_amount),1)):r("",!0),p.value.down_payment_amount?(l(),i("div",Ee,d(p.value.down_payment_amount),1)):r("",!0),e("div",De," Montant maximum: "+d(F(g.value)),1)]),o(a).payment_method==="cash"?(l(),i("div",We,[t[51]||(t[51]=e("label",{class:"form-label"},"Montant reçu (Fcfa)",-1)),e("div",Te,[b(e("input",{type:"number","onUpdate:modelValue":t[15]||(t[15]=s=>h.value=s),step:"0.01",min:"0",class:q(["form-control",{"is-invalid":h.value<(o(a).down_payment_amount>0?M.value:g.value)}]),placeholder:"0.00",disabled:o(a).down_payment_amount>0},null,10,$e),[[k,h.value,void 0,{number:!0}]]),t[50]||(t[50]=e("span",{class:"input-group-text"},"Fcfa",-1))]),h.value<(o(a).down_payment_amount>0?M.value:g.value)&&h.value>0?(l(),i("div",Re," Le montant reçu doit être au moins égal à "+d(o(a).down_payment_amount>0?"le reste à payer":"le montant total"),1)):r("",!0),o(a).down_payment_amount>0?(l(),i("div",ze," Montant à recevoir: "+d(F(M.value)),1)):(l(),i("div",Be," Montant à recevoir: "+d(F(g.value)),1))])):r("",!0),t[59]||(t[59]=e("hr",null,null,-1)),e("div",Oe,[t[52]||(t[52]=e("span",{class:"fw-bold"},"Total:",-1)),e("span",Qe,d(F(g.value)),1)]),o(a).down_payment_amount>0?(l(),i("div",Ge,[t[53]||(t[53]=e("span",null,"Acompte:",-1)),e("span",He,d(F(o(a).down_payment_amount)),1)])):r("",!0),o(a).down_payment_amount>0?(l(),i("div",Je,[t[54]||(t[54]=e("span",{class:"fw-bold"},"Reste à payer:",-1)),e("span",Ke,d(F(M.value)),1)])):r("",!0),o(a).payment_method==="cash"&&h.value>=(o(a).down_payment_amount>0?M.value:g.value)?(l(),i("div",Xe,[t[55]||(t[55]=e("span",{class:"fw-bold"},"Monnaie à rendre:",-1)),e("span",Ye,d(F(pt.value)),1)])):r("",!0),e("div",Ze,[e("button",{type:"button",onClick:_t,class:"btn btn-success",disabled:o(U)||o(a).items.length===0},[o(U)?(l(),i("span",en)):(l(),i("i",nn)),V(" "+d(o(U)?"Modification...":"Modifier la vente"),1)],8,tn),o(a).payment_status!=="paid"?(l(),i("button",{key:0,type:"button",onClick:ft,class:"btn btn-primary",disabled:o(U)},[...t[56]||(t[56]=[e("i",{class:"bi bi-credit-card me-1"},null,-1),V(" Marquer comme payé ",-1)])],8,an)):r("",!0),o(a).payment_status==="paid"?(l(),i("button",{key:1,type:"button",onClick:bt,class:"btn btn-warning",disabled:o(U)},[...t[57]||(t[57]=[e("i",{class:"bi bi-x-circle me-1"},null,-1),V(" Marquer comme non payé ",-1)])],8,sn)):r("",!0),T(o(Y),{href:o(I)("sales.index"),class:"btn btn-outline-secondary"},{default:B(()=>[...t[58]||(t[58]=[V(" Annuler ",-1)])]),_:1},8,["href"])])])])])])])]),_:1}))}}),gn=Mt(on,[["__scopeId","data-v-f5401658"]]);export{gn as default};
