import{d as $,r as z,c as w,w as f,a as e,j as g,f as c,u as d,l as p,m,b as o,e as C,v as x,o as n,F as _,g as h,t as a,p as S,n as y,h as T}from"./app-CsO4tl6o.js";import{_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-BRV_qoqt.js";import{r as b}from"./routes-C8N3XD_S.js";import{u as Q}from"./useSweetAlert-CjcY7Pj8.js";import{f as V,b as J}from"./BootstrapLayout-5r9ooxL-.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const O={class:"d-flex justify-content-between align-items-center mb-4"},P={class:"card mb-4"},W={class:"card-body"},X={class:"row g-3"},Y={class:"col-md-3"},Z={class:"input-group"},q={class:"col-md-2"},ee=["value"],se={class:"col-md-2"},te={class:"col-md-2"},le={class:"col-md-2"},ne={class:"card"},ie={class:"table-responsive"},oe={class:"table table-hover mb-0"},ae={class:"text-dark"},de={class:"d-flex align-items-center"},re={class:"fw-medium"},ue={class:"text-muted small"},ce={class:"small"},me={class:"fw-medium"},be={class:"text-muted"},fe={class:"fw-medium text-success"},pe={class:"d-flex align-items-center"},ve={class:"fw-medium"},ge={key:0,class:"small"},xe={class:"fw-medium"},_e={key:0,class:"badge bg-danger"},he={key:1,class:"badge bg-info"},ye={key:1,class:"text-muted small"},ke={class:"text-end"},we={class:"btn-group",role:"group"},Ce=["onClick"],Se={key:0,class:"card-footer"},Te={class:"d-flex justify-content-between align-items-center"},Ve={class:"d-none d-md-block"},De={class:"text-muted mb-0"},je={class:"fw-medium"},Ee={class:"fw-medium"},Me={class:"fw-medium"},Ne={class:"pagination pagination-sm mb-0"},Ae=["innerHTML"],Be=$({__name:"Index",props:{quotes:{},customers:{},filters:{}},setup(r){const D=r,{success:j,error:E,confirm:M}=Q(),i=z({...D.filters}),N=l=>new Intl.NumberFormat("fr-FR").format(l)+" Fcfa",A=l=>({draft:"Brouillon",sent:"Envoyé",accepted:"Accepté",rejected:"Refusé",expired:"Expiré"})[l]||l,B=l=>({draft:"bg-secondary",sent:"bg-info",accepted:"bg-success",rejected:"bg-danger",expired:"bg-warning text-dark"})[l]||"bg-secondary",F=l=>({draft:"bi bi-file-earmark",sent:"bi bi-send",accepted:"bi bi-check-circle",rejected:"bi bi-x-circle",expired:"bi bi-clock-history"})[l]||"bi bi-question-circle",I=l=>l?new Date(l)<new Date:!1,u=()=>{T.get(b("quotes.index"),i.value,{preserveState:!0,replace:!0})};let v=null;const L=()=>{v&&clearTimeout(v),v=setTimeout(()=>{u()},500)},H=()=>{i.value={},u()},R=()=>{i.value.search="",u()},U=async l=>{await M(`Êtes-vous sûr de vouloir supprimer le devis "${l.quote_number}" ?`)&&T.delete(b("quotes.destroy",{id:l.id}),{onSuccess:()=>{j(`Devis "${l.quote_number}" supprimé avec succès !`)},onError:t=>{const k=t.message||"Erreur lors de la suppression du devis.";E(k)}})};return(l,s)=>(n(),w(G,null,{default:f(()=>[e("div",O,[s[6]||(s[6]=e("div",null,[e("h1",{class:"h2 mb-1"},[e("i",{class:"bi bi-file-earmark-check me-2"}),c(" Devis ")]),e("p",{class:"text-muted mb-0"},"Gérez vos devis et propositions commerciales")],-1)),g(d(p),{href:d(b)("quotes.create"),class:"btn btn-primary"},{default:f(()=>[...s[5]||(s[5]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),c(" Nouveau devis ",-1)])]),_:1},8,["href"])]),e("div",P,[e("div",W,[e("div",X,[e("div",Y,[s[9]||(s[9]=e("label",{class:"form-label"},"Recherche",-1)),e("div",Z,[s[8]||(s[8]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),m(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>i.value.search=t),type:"text",placeholder:"Nom client ou numéro de devis...",class:"form-control",onInput:L},null,544),[[x,i.value.search]]),i.value.search?(n(),o("button",{key:0,onClick:R,class:"btn btn-outline-secondary",type:"button"},[...s[7]||(s[7]=[e("i",{class:"bi bi-x"},null,-1)])])):C("",!0)])]),e("div",q,[s[11]||(s[11]=e("label",{class:"form-label"},"Client",-1)),m(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>i.value.customer_id=t),class:"form-select",onChange:u},[s[10]||(s[10]=e("option",{value:""},"Tous les clients",-1)),(n(!0),o(_,null,h(r.customers,t=>(n(),o("option",{key:t.id,value:t.id},a(t.name),9,ee))),128))],544),[[S,i.value.customer_id]])]),e("div",se,[s[13]||(s[13]=e("label",{class:"form-label"},"Statut",-1)),m(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>i.value.status=t),class:"form-select",onChange:u},[...s[12]||(s[12]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"draft"},"Brouillon",-1),e("option",{value:"sent"},"Envoyé",-1),e("option",{value:"accepted"},"Accepté",-1),e("option",{value:"rejected"},"Refusé",-1),e("option",{value:"expired"},"Expiré",-1)])],544),[[S,i.value.status]])]),e("div",te,[s[14]||(s[14]=e("label",{class:"form-label"},"Date de début",-1)),m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>i.value.date_from=t),type:"date",class:"form-control",onChange:u},null,544),[[x,i.value.date_from]])]),e("div",le,[s[15]||(s[15]=e("label",{class:"form-label"},"Date de fin",-1)),m(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>i.value.date_to=t),type:"date",class:"form-control",onChange:u},null,544),[[x,i.value.date_to]])]),e("div",{class:"col-md-1 d-flex align-items-end"},[e("button",{onClick:H,class:"btn btn-outline-secondary w-100"},[...s[16]||(s[16]=[e("i",{class:"bi bi-x-circle"},null,-1)])])])])])]),e("div",ne,[e("div",ie,[e("table",oe,[s[23]||(s[23]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Numéro"),e("th",null,"Client"),e("th",null,"Date"),e("th",null,"Montant"),e("th",null,"Articles"),e("th",null,"Statut"),e("th",null,"Validité"),e("th",{class:"text-end"},"Actions")])],-1)),e("tbody",null,[(n(!0),o(_,null,h(r.quotes.data,t=>(n(),o("tr",{key:t.id},[e("td",null,[e("code",ae,a(t.quote_number),1)]),e("td",null,[e("div",de,[s[17]||(s[17]=e("div",{class:"flex-shrink-0 me-2"},[e("div",{class:"bg-light rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"}},[e("i",{class:"bi bi-person text-muted"})])],-1)),e("div",null,[e("div",re,a(t.customer?.name||"Client anonyme"),1),e("div",ue,a(t.customer?.email||""),1)])])]),e("td",null,[e("div",ce,[e("div",me,a(d(V)(t.created_at)),1),e("div",be,a(d(J)(t.created_at)),1)])]),e("td",null,[e("div",fe,a(N(t.total_amount)),1)]),e("td",null,[e("div",pe,[s[18]||(s[18]=e("div",{class:"bg-light rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"24px",height:"24px"}},[e("i",{class:"bi bi-box text-muted small"})],-1)),e("span",ve,a(t.items_count||0),1),s[19]||(s[19]=e("span",{class:"text-muted ms-1 small"},"article(s)",-1))])]),e("td",null,[e("span",{class:y(["badge",B(t.status)])},[e("i",{class:y(["me-1",F(t.status)])},null,2),c(" "+a(A(t.status)),1)],2)]),e("td",null,[t.valid_until?(n(),o("div",ge,[e("div",xe,a(d(V)(t.valid_until)),1),I(t.valid_until)?(n(),o("span",_e," Expiré ")):(n(),o("span",he," Valide "))])):(n(),o("span",ye,"-"))]),e("td",ke,[e("div",we,[g(d(p),{href:d(b)("quotes.show",{id:t.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:f(()=>[...s[20]||(s[20]=[e("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),g(d(p),{href:d(b)("quotes.edit",{id:t.id}),class:"btn btn-sm btn-outline-secondary",title:"Modifier"},{default:f(()=>[...s[21]||(s[21]=[e("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"]),e("button",{onClick:k=>U(t),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...s[22]||(s[22]=[e("i",{class:"bi bi-trash"},null,-1)])],8,Ce)])])]))),128))])])]),r.quotes.links?(n(),o("div",Se,[e("div",Te,[e("div",Ve,[e("p",De,[s[24]||(s[24]=c(" Affichage de ",-1)),e("span",je,a(r.quotes.from),1),s[25]||(s[25]=c(" à ",-1)),e("span",Ee,a(r.quotes.to),1),s[26]||(s[26]=c(" sur ",-1)),e("span",Me,a(r.quotes.total),1),s[27]||(s[27]=c(" résultats ",-1))])]),e("nav",null,[e("ul",Ne,[(n(!0),o(_,null,h(r.quotes.links,t=>(n(),o("li",{key:t.label,class:y(["page-item",{active:t.active,disabled:!t.url}])},[t.url?(n(),w(d(p),{key:0,href:t.url,class:"page-link",innerHTML:t.label},null,8,["href","innerHTML"])):(n(),o("span",{key:1,class:"page-link",innerHTML:t.label},null,8,Ae))],2))),128))])])])])):C("",!0)])]),_:1}))}}),ze=K(Be,[["__scopeId","data-v-e444e9ec"]]);export{ze as default};
