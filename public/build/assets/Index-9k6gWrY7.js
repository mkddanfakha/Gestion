import{u as C,B as L}from"./BootstrapLayout-CnHsE3D3.js";import{d as S,c as h,w as c,a as e,j as v,f as m,u as a,l as b,b as n,e as f,o as i,F as y,g as _,t as r,n as u,h as A}from"./app-DQWaqSr_.js";import{r as p}from"./routes-C8N3XD_S.js";import{S as g}from"./sweetalert2.esm.all-NNS-RXd7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"d-flex justify-content-between align-items-center mb-4"},T={class:"card"},V={class:"table-responsive"},j={class:"table table-hover mb-0"},E={class:"d-flex align-items-center"},M={class:"fw-medium"},N={class:"text-muted small"},H={class:"text-end"},U={class:"btn-group",role:"group"},z=["onClick"],F={key:0},G={key:0,class:"card-footer"},I={class:"d-flex justify-content-center"},R={class:"pagination mb-0"},$=["innerHTML"],Q=S({__name:"Index",props:{users:{}},setup(o){const{isAdmin:x}=C(),k=l=>({admin:"Administrateur",vendeur:"Vendeur",gestionnaire:"Gestionnaire",user:"Utilisateur"})[l]||"Utilisateur",B=l=>new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}),w=l=>{g.fire({title:"Êtes-vous sûr ?",text:`Voulez-vous vraiment supprimer l'utilisateur "${l.name}" ?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Oui, supprimer",cancelButtonText:"Annuler"}).then(s=>{s.isConfirmed&&A.delete(p("admin.users.destroy",l.id),{onSuccess:()=>{g.fire({title:"Supprimé !",text:"L'utilisateur a été supprimé avec succès.",icon:"success",timer:2e3,showConfirmButton:!1})},onError:t=>{const d=t?.message||t?.error||"Une erreur est survenue lors de la suppression.";g.fire({title:"Erreur !",text:d,icon:"error"})}})})};return(l,s)=>(i(),h(L,null,{default:c(()=>[e("div",D,[s[1]||(s[1]=e("div",null,[e("h1",{class:"h2 mb-1"},[e("i",{class:"bi bi-shield-lock me-2"}),m(" Gestion des utilisateurs ")]),e("p",{class:"text-muted mb-0"},"Gérez les utilisateurs et leurs rôles")],-1)),v(a(b),{href:a(p)("admin.users.create"),class:"btn btn-primary"},{default:c(()=>[...s[0]||(s[0]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),m(" Ajouter un utilisateur ",-1)])]),_:1},8,["href"])]),e("div",T,[e("div",V,[e("table",j,[s[6]||(s[6]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Utilisateur"),e("th",null,"Email"),e("th",null,"Rôle"),e("th",null,"Email vérifié"),e("th",null,"Statut"),e("th",null,"Date de création"),e("th",{class:"text-end"},"Actions")])],-1)),e("tbody",null,[(i(!0),n(y,null,_(o.users.data,t=>(i(),n("tr",{key:t.id},[e("td",null,[e("div",E,[s[2]||(s[2]=e("div",{class:"flex-shrink-0 me-3"},[e("div",{class:"bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"}},[e("i",{class:"bi bi-person text-primary"})])],-1)),e("div",null,[e("div",M,r(t.name),1),e("div",N,"ID: "+r(t.id),1)])])]),e("td",null,r(t.email),1),e("td",null,[e("span",{class:u(["badge",{"bg-danger":t.role==="admin","bg-primary":t.role==="vendeur","bg-info":t.role==="gestionnaire","bg-secondary":t.role==="user"}])},r(k(t.role)),3)]),e("td",null,[e("span",{class:u(["badge",t.email_verified_at?"bg-success":"bg-warning text-dark"])},[e("i",{class:u([t.email_verified_at?"bi bi-check-circle":"bi bi-exclamation-triangle","me-1"])},null,2),m(" "+r(t.email_verified_at?"Vérifié":"Non vérifié"),1)],2)]),e("td",null,[e("span",{class:u(["badge",t.is_active?"bg-success":"bg-secondary"])},r(t.is_active?"Actif":"Inactif"),3)]),e("td",null,r(B(t.created_at)),1),e("td",H,[e("div",U,[v(a(b),{href:a(p)("admin.users.edit",t.id),class:"btn btn-sm btn-outline-primary"},{default:c(()=>[...s[3]||(s[3]=[e("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"]),a(x)&&t.id!==l.$page.props.auth.user?.id?(i(),n("button",{key:0,onClick:d=>w(t),class:"btn btn-sm btn-outline-danger",title:"Seuls les administrateurs peuvent supprimer des utilisateurs"},[...s[4]||(s[4]=[e("i",{class:"bi bi-trash"},null,-1)])],8,z)):f("",!0)])])]))),128)),o.users.data.length===0?(i(),n("tr",F,[...s[5]||(s[5]=[e("td",{colspan:"7",class:"text-center text-muted py-4"}," Aucun utilisateur trouvé ",-1)])])):f("",!0)])])]),o.users.links&&o.users.links.length>3?(i(),n("div",G,[e("div",I,[e("nav",null,[e("ul",R,[(i(!0),n(y,null,_(o.users.links,(t,d)=>(i(),n("li",{key:d,class:u(["page-item",{active:t.active,disabled:!t.url}])},[t.url?(i(),h(a(b),{key:0,href:t.url,class:"page-link",innerHTML:t.label},null,8,["href","innerHTML"])):(i(),n("span",{key:1,class:"page-link",innerHTML:t.label},null,8,$))],2))),128))])])])])):f("",!0)])]),_:1}))}});export{Q as default};
