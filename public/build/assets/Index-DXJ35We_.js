import{D as J,E as $,G as K,d as Y,r as E,y as I,c as H,w as F,a as e,b,e as q,j as R,f as U,u as p,l as N,t as r,m as L,v as B,p as z,o as f,F as G,g as P,n as Z,h as ee}from"./app-CGqa7dvF.js";import{_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-CUowRV7B.js";import{r as V}from"./routes-Ds1K_LXc.js";import{u as se}from"./useSweetAlert-CjcY7Pj8.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BootstrapLayout-L_TowVZG.js";import"./sweetalert2.esm.all-NNS-RXd7.js";var ie=/\s/;function le(i){for(var l=i.length;l--&&ie.test(i.charAt(l)););return l}var oe=/^\s+/;function ae(i){return i&&i.slice(0,le(i)+1).replace(oe,"")}var Q=NaN,re=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,ue=/^0o[0-7]+$/i,ce=parseInt;function X(i){if(typeof i=="number")return i;if(J(i))return Q;if($(i)){var l=typeof i.valueOf=="function"?i.valueOf():i;i=$(l)?l+"":l}if(typeof i!="string")return i===0?i:+i;i=ae(i);var c=de.test(i);return c||ue.test(i)?ce(i.slice(2),c?2:8):re.test(i)?Q:+i}var W=function(){return K.Date.now()},me="Expected a function",fe=Math.max,ve=Math.min;function be(i,l,c){var g,h,v,u,a,d,m=0,C=!1,_=!1,T=!0;if(typeof i!="function")throw new TypeError(me);l=X(l)||0,$(c)&&(C=!!c.leading,_="maxWait"in c,v=_?fe(X(c.maxWait)||0,l):v,T="trailing"in c?!!c.trailing:T);function k(o){var n=g,t=h;return g=h=void 0,m=o,u=i.apply(t,n),u}function A(o){return m=o,a=setTimeout(x,l),C?k(o):u}function S(o){var n=o-d,t=o-m,s=l-n;return _?ve(s,v-t):s}function y(o){var n=o-d,t=o-m;return d===void 0||n>=l||n<0||_&&t>=v}function x(){var o=W();if(y(o))return D(o);a=setTimeout(x,S(o))}function D(o){return a=void 0,T&&g?k(o):(g=h=void 0,u)}function j(){a!==void 0&&clearTimeout(a),m=0,g=d=h=a=void 0}function w(){return a===void 0?u:D(W())}function M(){var o=W(),n=y(o);if(g=arguments,h=this,d=o,n){if(a===void 0)return A(d);if(_)return clearTimeout(a),a=setTimeout(x,l),k(d)}return a===void 0&&(a=setTimeout(x,l)),u}return M.cancel=j,M.flush=w,M}const pe={class:"d-flex justify-content-between align-items-center mb-4"},ge={class:"row mb-4"},he={class:"col-md-3"},_e={class:"card bg-primary text-white"},ye={class:"card-body"},xe={class:"d-flex justify-content-between"},we={class:"mb-0"},Ce={class:"col-md-3"},Te={class:"card bg-info text-white"},ke={class:"card-body"},Me={class:"d-flex justify-content-between"},Ee={class:"card-title"},Ie={class:"mb-0"},Le={class:"col-md-3"},Se={class:"card bg-warning text-white"},De={class:"card-body"},Fe={class:"d-flex justify-content-between"},Ne={class:"mb-0"},Ve={class:"col-md-3"},Ae={class:"card bg-success text-white"},je={class:"card-body"},Re={class:"d-flex justify-content-between"},Ue={class:"mb-0"},Be={class:"card mb-4"},We={class:"card-body"},$e={class:"row g-3"},Oe={class:"col-md-3"},He={class:"col-md-2"},qe={class:"col-md-2"},ze={class:"col-md-2"},Ge={class:"col-md-2"},Pe={class:"card"},Qe={class:"card-body p-0"},Xe={key:0,class:"text-center py-5"},Je={key:1,class:"table-responsive"},Ke={class:"table table-hover mb-0"},Ye={class:"badge bg-primary"},Ze={class:"fw-medium"},et={key:0,class:"text-muted small"},tt={class:"badge bg-info"},st={class:"fw-bold text-danger"},nt={class:"badge bg-secondary"},it={class:"text-muted small"},lt={class:"d-flex align-items-center"},ot={class:"avatar-sm bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2"},at={class:"fw-medium"},rt={class:"btn-group",role:"group"},dt=["onClick"],ut={key:0,class:"d-flex justify-content-center mt-4"},ct={class:"pagination"},mt=["innerHTML"],ft=Y({__name:"Index",props:{expenses:{},statistics:{}},setup(i){const l=i,{success:c,error:g,confirm:h}=se(),v=E(""),u=E(""),a=E(""),d=E(""),m=E(""),C=be(()=>{},300),_=I(()=>l.statistics?.total||0),T=I(()=>l.statistics?.monthly||0),k=I(()=>l.statistics?.weekly||0),A=I(()=>{const n=new Date().toLocaleDateString("fr-FR",{month:"long"});return n.charAt(0).toUpperCase()+n.slice(1)}),S=I(()=>{let n=l.expenses.data;if(v.value){const t=v.value.toLowerCase();n=n.filter(s=>s.title.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)||s.vendor?.toLowerCase().includes(t)||s.receipt_number?.toLowerCase().includes(t))}return u.value&&(n=n.filter(t=>t.category===u.value)),a.value&&(n=n.filter(t=>t.payment_method===a.value)),d.value&&(n=n.filter(t=>t.expense_date>=d.value)),m.value&&(n=n.filter(t=>t.expense_date<=m.value)),n}),y=n=>new Intl.NumberFormat("fr-FR").format(n)+" Fcfa",x=n=>new Date(n).toLocaleDateString("fr-FR"),D=n=>new Date(n).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),j=(n,t)=>n.length>t?n.substring(0,t)+"...":n,w=()=>{},M=()=>{v.value="",u.value="",a.value="",d.value="",m.value=""},o=async n=>{await h(`Êtes-vous sûr de vouloir supprimer la dépense "${n.title}" ?`)&&ee.delete(V("expenses.destroy",{id:n.id}),{onSuccess:()=>{c(`Dépense "${n.title}" supprimée avec succès !`)},onError:s=>{const O=s.message||"Erreur lors de la suppression de la dépense.";g(O)}})};return(n,t)=>(f(),H(te,null,{default:F(()=>[e("div",pe,[t[7]||(t[7]=e("div",null,[e("h1",{class:"h2 mb-1"},[e("i",{class:"bi bi-receipt me-2"}),U(" Gestion des dépenses ")]),e("p",{class:"text-muted mb-0"},"Suivez et gérez toutes vos dépenses")],-1)),R(p(N),{href:p(V)("expenses.create"),class:"btn btn-primary"},{default:F(()=>[...t[6]||(t[6]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),U(" Nouvelle dépense ",-1)])]),_:1},8,["href"])]),e("div",ge,[e("div",he,[e("div",_e,[e("div",ye,[e("div",xe,[e("div",null,[t[8]||(t[8]=e("h6",{class:"card-title"},"Total dépenses",-1)),e("h4",we,r(y(_.value)),1)]),t[9]||(t[9]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-currency-exchange fs-1"})],-1))])])])]),e("div",Ce,[e("div",Te,[e("div",ke,[e("div",Me,[e("div",null,[e("h6",Ee,"Ce mois ("+r(A.value)+")",1),e("h4",Ie,r(y(T.value)),1)]),t[10]||(t[10]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-calendar-month fs-1"})],-1))])])])]),e("div",Le,[e("div",Se,[e("div",De,[e("div",Fe,[e("div",null,[t[11]||(t[11]=e("h6",{class:"card-title"},"Cette semaine",-1)),e("h4",Ne,r(y(k.value)),1)]),t[12]||(t[12]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-calendar-week fs-1"})],-1))])])])]),e("div",Ve,[e("div",Ae,[e("div",je,[e("div",Re,[e("div",null,[t[13]||(t[13]=e("h6",{class:"card-title"},"Nombre total",-1)),e("h4",Ue,r(i.expenses.meta?.total||i.expenses.data.length),1)]),t[14]||(t[14]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-list-ul fs-1"})],-1))])])])])]),e("div",Be,[e("div",We,[e("div",$e,[e("div",Oe,[t[15]||(t[15]=e("label",{class:"form-label"},"Rechercher",-1)),L(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),type:"text",class:"form-control",placeholder:"Titre, description...",onInput:t[1]||(t[1]=(...s)=>p(C)&&p(C)(...s))},null,544),[[B,v.value]])]),e("div",He,[t[17]||(t[17]=e("label",{class:"form-label"},"Catégorie",-1)),L(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>u.value=s),class:"form-select",onChange:w},[...t[16]||(t[16]=[e("option",{value:""},"Toutes les catégories",-1),e("option",{value:"fournitures"},"Fournitures",-1),e("option",{value:"equipement"},"Équipement",-1),e("option",{value:"marketing"},"Marketing",-1),e("option",{value:"transport"},"Transport",-1),e("option",{value:"formation"},"Formation",-1),e("option",{value:"maintenance"},"Maintenance",-1),e("option",{value:"utilities"},"Services publics",-1),e("option",{value:"autres"},"Autres",-1)])],544),[[z,u.value]])]),e("div",qe,[t[19]||(t[19]=e("label",{class:"form-label"},"Méthode de paiement",-1)),L(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value=s),class:"form-select",onChange:w},[...t[18]||(t[18]=[e("option",{value:""},"Toutes les méthodes",-1),e("option",{value:"cash"},"Espèces",-1),e("option",{value:"bank_transfer"},"Virement bancaire",-1),e("option",{value:"credit_card"},"Carte de crédit",-1),e("option",{value:"mobile_money"},"Mobile Money",-1),e("option",{value:"orange_money"},"Orange Money",-1),e("option",{value:"wave"},"Wave",-1),e("option",{value:"check"},"Chèque",-1)])],544),[[z,a.value]])]),e("div",ze,[t[20]||(t[20]=e("label",{class:"form-label"},"Date de début",-1)),L(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>d.value=s),type:"date",class:"form-control",onChange:w},null,544),[[B,d.value]])]),e("div",Ge,[t[21]||(t[21]=e("label",{class:"form-label"},"Date de fin",-1)),L(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>m.value=s),type:"date",class:"form-control",onChange:w},null,544),[[B,m.value]])]),e("div",{class:"col-md-1 d-flex align-items-end"},[e("button",{onClick:M,class:"btn btn-outline-secondary",title:"Effacer les filtres"},[...t[22]||(t[22]=[e("i",{class:"bi bi-x-circle"},null,-1)])])])])])]),e("div",Pe,[t[28]||(t[28]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},[e("i",{class:"bi bi-list-ul me-2"}),U(" Liste des dépenses ")])],-1)),e("div",Qe,[S.value.length===0?(f(),b("div",Xe,[...t[23]||(t[23]=[e("i",{class:"bi bi-receipt fs-1 text-muted"},null,-1),e("p",{class:"text-muted mt-3"},"Aucune dépense trouvée",-1)])])):(f(),b("div",Je,[e("table",Ke,[t[27]||(t[27]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Numéro"),e("th",null,"Titre"),e("th",null,"Catégorie"),e("th",null,"Montant"),e("th",null,"Méthode de paiement"),e("th",null,"Date"),e("th",null,"Créé par"),e("th",null,"Actions")])],-1)),e("tbody",null,[(f(!0),b(G,null,P(S.value,s=>(f(),b("tr",{key:s.id},[e("td",null,[e("span",Ye,r(s.expense_number),1)]),e("td",null,[e("div",Ze,r(s.title),1),s.description?(f(),b("div",et,r(j(s.description,50)),1)):q("",!0)]),e("td",null,[e("span",tt,r(s.category_label),1)]),e("td",null,[e("span",st,r(y(s.amount)),1)]),e("td",null,[e("span",nt,r(s.payment_method_label),1)]),e("td",null,[e("div",null,r(x(s.expense_date)),1),e("div",it,r(D(s.created_at)),1)]),e("td",null,[e("div",lt,[e("div",ot,r(s.user.name.charAt(0).toUpperCase()),1),e("div",null,[e("div",at,r(s.user.name),1)])])]),e("td",null,[e("div",rt,[R(p(N),{href:p(V)("expenses.show",{id:s.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:F(()=>[...t[24]||(t[24]=[e("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),R(p(N),{href:p(V)("expenses.edit",{id:s.id}),class:"btn btn-sm btn-outline-warning",title:"Modifier"},{default:F(()=>[...t[25]||(t[25]=[e("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"]),e("button",{onClick:O=>o(s),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...t[26]||(t[26]=[e("i",{class:"bi bi-trash"},null,-1)])],8,dt)])])]))),128))])])]))])]),i.expenses.links?(f(),b("div",ut,[e("nav",null,[e("ul",ct,[(f(!0),b(G,null,P(i.expenses.links,s=>(f(),b("li",{key:s.label,class:Z(["page-item",{active:s.active,disabled:!s.url}])},[s.url?(f(),H(p(N),{key:0,href:s.url,class:"page-link",innerHTML:s.label},null,8,["href","innerHTML"])):(f(),b("span",{key:1,class:"page-link",innerHTML:s.label},null,8,mt))],2))),128))])])])):q("",!0)]),_:1}))}}),xt=ne(ft,[["__scopeId","data-v-e7ff5cab"]]);export{xt as default};
