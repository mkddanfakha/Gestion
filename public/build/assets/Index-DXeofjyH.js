import{d as z,r as G,c as C,w as f,a as e,j as g,f as u,u as c,l as p,m,b as o,e as S,v as x,o as n,F as _,g as h,t as a,p as D,n as y,h as T}from"./app--1_n6QmE.js";import{_ as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-DiNSmrMh.js";import{r as b}from"./routes-BdA70M5q.js";import{u as J}from"./useSweetAlert-CjcY7Pj8.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BootstrapLayout-DS_PED8n.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const O={class:"d-flex justify-content-between align-items-center mb-4"},P={class:"card mb-4"},W={class:"card-body"},X={class:"row g-3"},Y={class:"col-md-3"},Z={class:"input-group"},q={class:"col-md-2"},ee=["value"],te={class:"col-md-2"},se={class:"col-md-2"},le={class:"col-md-2"},ne={class:"card"},ie={class:"table-responsive"},oe={class:"table table-hover mb-0"},ae={class:"text-dark"},re={class:"d-flex align-items-center"},de={class:"fw-medium"},ue={class:"text-muted small"},ce={class:"small"},me={class:"fw-medium"},be={class:"text-muted"},fe={class:"fw-medium text-success"},pe={class:"d-flex align-items-center"},ve={class:"fw-medium"},ge={key:0,class:"small"},xe={class:"fw-medium"},_e={key:0,class:"badge bg-danger"},he={key:1,class:"badge bg-info"},ye={key:1,class:"text-muted small"},ke={class:"text-end"},we={class:"btn-group",role:"group"},Ce=["onClick"],Se={key:0,class:"card-footer"},De={class:"d-flex justify-content-between align-items-center"},Te={class:"d-none d-md-block"},Ve={class:"text-muted mb-0"},je={class:"fw-medium"},Ee={class:"fw-medium"},Me={class:"fw-medium"},Fe={class:"pagination pagination-sm mb-0"},Le=["innerHTML"],Ne=z({__name:"Index",props:{quotes:{},customers:{},filters:{}},setup(r){const V=r,{success:j,error:E,confirm:M}=J(),i=G({...V.filters}),F=l=>new Intl.NumberFormat("fr-FR").format(l)+" Fcfa",k=l=>new Date(l).toLocaleDateString("fr-FR"),L=l=>new Date(l).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),N=l=>({draft:"Brouillon",sent:"Envoyé",accepted:"Accepté",rejected:"Refusé",expired:"Expiré"})[l]||l,A=l=>({draft:"bg-secondary",sent:"bg-info",accepted:"bg-success",rejected:"bg-danger",expired:"bg-warning text-dark"})[l]||"bg-secondary",B=l=>({draft:"bi bi-file-earmark",sent:"bi bi-send",accepted:"bi bi-check-circle",rejected:"bi bi-x-circle",expired:"bi bi-clock-history"})[l]||"bi bi-question-circle",I=l=>l?new Date(l)<new Date:!1,d=()=>{T.get(b("quotes.index"),i.value,{preserveState:!0,replace:!0})};let v=null;const R=()=>{v&&clearTimeout(v),v=setTimeout(()=>{d()},500)},H=()=>{i.value={},d()},U=()=>{i.value.search="",d()},$=async l=>{await M(`Êtes-vous sûr de vouloir supprimer le devis "${l.quote_number}" ?`)&&T.delete(b("quotes.destroy",{id:l.id}),{onSuccess:()=>{j(`Devis "${l.quote_number}" supprimé avec succès !`)},onError:s=>{const w=s.message||"Erreur lors de la suppression du devis.";E(w)}})};return(l,t)=>(n(),C(Q,null,{default:f(()=>[e("div",O,[t[6]||(t[6]=e("div",null,[e("h1",{class:"h2 mb-1"},[e("i",{class:"bi bi-file-earmark-check me-2"}),u(" Devis ")]),e("p",{class:"text-muted mb-0"},"Gérez vos devis et propositions commerciales")],-1)),g(c(p),{href:c(b)("quotes.create"),class:"btn btn-primary"},{default:f(()=>[...t[5]||(t[5]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),u(" Nouveau devis ",-1)])]),_:1},8,["href"])]),e("div",P,[e("div",W,[e("div",X,[e("div",Y,[t[9]||(t[9]=e("label",{class:"form-label"},"Recherche",-1)),e("div",Z,[t[8]||(t[8]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.value.search=s),type:"text",placeholder:"Nom client ou numéro de devis...",class:"form-control",onInput:R},null,544),[[x,i.value.search]]),i.value.search?(n(),o("button",{key:0,onClick:U,class:"btn btn-outline-secondary",type:"button"},[...t[7]||(t[7]=[e("i",{class:"bi bi-x"},null,-1)])])):S("",!0)])]),e("div",q,[t[11]||(t[11]=e("label",{class:"form-label"},"Client",-1)),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.value.customer_id=s),class:"form-select",onChange:d},[t[10]||(t[10]=e("option",{value:""},"Tous les clients",-1)),(n(!0),o(_,null,h(r.customers,s=>(n(),o("option",{key:s.id,value:s.id},a(s.name),9,ee))),128))],544),[[D,i.value.customer_id]])]),e("div",te,[t[13]||(t[13]=e("label",{class:"form-label"},"Statut",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.status=s),class:"form-select",onChange:d},[...t[12]||(t[12]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"draft"},"Brouillon",-1),e("option",{value:"sent"},"Envoyé",-1),e("option",{value:"accepted"},"Accepté",-1),e("option",{value:"rejected"},"Refusé",-1),e("option",{value:"expired"},"Expiré",-1)])],544),[[D,i.value.status]])]),e("div",se,[t[14]||(t[14]=e("label",{class:"form-label"},"Date de début",-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.value.date_from=s),type:"date",class:"form-control",onChange:d},null,544),[[x,i.value.date_from]])]),e("div",le,[t[15]||(t[15]=e("label",{class:"form-label"},"Date de fin",-1)),m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.value.date_to=s),type:"date",class:"form-control",onChange:d},null,544),[[x,i.value.date_to]])]),e("div",{class:"col-md-1 d-flex align-items-end"},[e("button",{onClick:H,class:"btn btn-outline-secondary w-100"},[...t[16]||(t[16]=[e("i",{class:"bi bi-x-circle"},null,-1)])])])])])]),e("div",ne,[e("div",ie,[e("table",oe,[t[23]||(t[23]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Numéro"),e("th",null,"Client"),e("th",null,"Date"),e("th",null,"Montant"),e("th",null,"Articles"),e("th",null,"Statut"),e("th",null,"Validité"),e("th",{class:"text-end"},"Actions")])],-1)),e("tbody",null,[(n(!0),o(_,null,h(r.quotes.data,s=>(n(),o("tr",{key:s.id},[e("td",null,[e("code",ae,a(s.quote_number),1)]),e("td",null,[e("div",re,[t[17]||(t[17]=e("div",{class:"flex-shrink-0 me-2"},[e("div",{class:"bg-light rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"}},[e("i",{class:"bi bi-person text-muted"})])],-1)),e("div",null,[e("div",de,a(s.customer?.name||"Client anonyme"),1),e("div",ue,a(s.customer?.email||""),1)])])]),e("td",null,[e("div",ce,[e("div",me,a(k(s.created_at)),1),e("div",be,a(L(s.created_at)),1)])]),e("td",null,[e("div",fe,a(F(s.total_amount)),1)]),e("td",null,[e("div",pe,[t[18]||(t[18]=e("div",{class:"bg-light rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"24px",height:"24px"}},[e("i",{class:"bi bi-box text-muted small"})],-1)),e("span",ve,a(s.items_count||0),1),t[19]||(t[19]=e("span",{class:"text-muted ms-1 small"},"article(s)",-1))])]),e("td",null,[e("span",{class:y(["badge",A(s.status)])},[e("i",{class:y(["me-1",B(s.status)])},null,2),u(" "+a(N(s.status)),1)],2)]),e("td",null,[s.valid_until?(n(),o("div",ge,[e("div",xe,a(k(s.valid_until)),1),I(s.valid_until)?(n(),o("span",_e," Expiré ")):(n(),o("span",he," Valide "))])):(n(),o("span",ye,"-"))]),e("td",ke,[e("div",we,[g(c(p),{href:c(b)("quotes.show",{id:s.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:f(()=>[...t[20]||(t[20]=[e("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),g(c(p),{href:c(b)("quotes.edit",{id:s.id}),class:"btn btn-sm btn-outline-secondary",title:"Modifier"},{default:f(()=>[...t[21]||(t[21]=[e("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"]),e("button",{onClick:w=>$(s),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...t[22]||(t[22]=[e("i",{class:"bi bi-trash"},null,-1)])],8,Ce)])])]))),128))])])]),r.quotes.links?(n(),o("div",Se,[e("div",De,[e("div",Te,[e("p",Ve,[t[24]||(t[24]=u(" Affichage de ",-1)),e("span",je,a(r.quotes.from),1),t[25]||(t[25]=u(" à ",-1)),e("span",Ee,a(r.quotes.to),1),t[26]||(t[26]=u(" sur ",-1)),e("span",Me,a(r.quotes.total),1),t[27]||(t[27]=u(" résultats ",-1))])]),e("nav",null,[e("ul",Fe,[(n(!0),o(_,null,h(r.quotes.links,s=>(n(),o("li",{key:s.label,class:y(["page-item",{active:s.active,disabled:!s.url}])},[s.url?(n(),C(c(p),{key:0,href:s.url,class:"page-link",innerHTML:s.label},null,8,["href","innerHTML"])):(n(),o("span",{key:1,class:"page-link",innerHTML:s.label},null,8,Le))],2))),128))])])])])):S("",!0)])]),_:1}))}}),ze=K(Ne,[["__scopeId","data-v-7b375268"]]);export{ze as default};
