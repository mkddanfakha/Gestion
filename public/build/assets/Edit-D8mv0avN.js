import{d as B,r as E,i as A,c as M,w as _,a as t,t as r,j as h,u as s,l as V,f as y,m as v,b as m,e as c,n as f,v as b,o as d,q}from"./app-CGqa7dvF.js";import{_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-CUowRV7B.js";import{r as k}from"./routes-Ds1K_LXc.js";import{u as L}from"./useSweetAlert-CjcY7Pj8.js";import"./BootstrapLayout-L_TowVZG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-NNS-RXd7.js";const j={class:"d-flex justify-content-between align-items-center mb-4"},F={class:"text-muted mb-0"},N={class:"d-flex gap-2"},S={class:"row justify-content-center"},T={class:"col-lg-8"},D={class:"card mb-4"},z={class:"card-body"},O={class:"row g-3"},P={class:"col-md-6"},R={key:0,class:"invalid-feedback"},G={key:1,class:"invalid-feedback"},H={class:"col-md-6"},J={key:0,class:"invalid-feedback"},K={key:1,class:"invalid-feedback"},Q={class:"col-md-6"},W={key:0,class:"invalid-feedback"},X={key:1,class:"invalid-feedback"},Y={class:"col-md-6"},Z={class:"input-group"},ee={key:0,class:"invalid-feedback"},se={key:1,class:"invalid-feedback"},te={class:"card mb-4"},ie={class:"card-body"},le={class:"row g-3"},oe={class:"col-12"},ne={key:0,class:"invalid-feedback"},ae={class:"col-md-4"},de={key:0,class:"invalid-feedback"},re={class:"col-md-4"},me={key:0,class:"invalid-feedback"},ce={class:"col-md-4"},ue={key:0,class:"invalid-feedback"},ve={class:"card mb-4"},pe={class:"card-body"},fe={class:"form-check form-switch"},be={class:"d-flex gap-2"},ye=["disabled"],_e={key:0,class:"spinner-border spinner-border-sm me-2"},ke={key:1,class:"bi bi-check-circle me-1"},Ce=B({__name:"Edit",props:{customer:{}},setup(x){const u=x,{success:w,error:$}=L(),n=E({}),U=()=>{const a={};return(!i.name||i.name.trim().length<2)&&(a.name="Le nom du client est requis (minimum 2 caractères)"),i.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)&&(a.email="Adresse email invalide"),i.phone&&!/^[\+]?[0-9\s\-\(\)]{8,}$/.test(i.phone)&&(a.phone="Numéro de téléphone invalide"),i.credit_limit<0&&(a.credit_limit="La limite de crédit ne peut pas être négative"),Object.keys(a).length===0?null:a},p=(a,e)=>{n.value[a]&&delete n.value[a];let l="";switch(a){case"name":(!e||e.trim().length<2)&&(l="Le nom du client est requis (minimum 2 caractères)");break;case"email":e&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)&&(l="Adresse email invalide");break;case"phone":e&&!/^[\+]?[0-9\s\-\(\)]{8,}$/.test(e)&&(l="Numéro de téléphone invalide");break;case"credit_limit":e<0&&(l="La limite de crédit ne peut pas être négative");break}l&&(n.value[a]=l)},i=A({name:u.customer.name,email:u.customer.email||"",phone:u.customer.phone||"",address:u.customer.address||"",city:u.customer.city||"",postal_code:u.customer.postal_code||"",country:u.customer.country||"",credit_limit:u.customer.credit_limit,is_active:u.customer.is_active}),C=()=>{n.value={};const a=U();if(a){n.value=a;return}i.put(k("customers.update",{id:u.customer.id}),{onSuccess:()=>{w("Client modifié avec succès !"),n.value={}},onError:()=>{$("Erreur lors de la modification du client.")}})},{errors:o,processing:g}=i;return(a,e)=>(d(),M(I,null,{default:_(()=>[t("div",j,[t("div",null,[e[17]||(e[17]=t("h1",{class:"h2 mb-1"},"Modifier le client",-1)),t("p",F,r(x.customer.name),1)]),t("div",N,[h(s(V),{href:s(k)("customers.show",{id:x.customer.id}),class:"btn btn-outline-primary"},{default:_(()=>[...e[18]||(e[18]=[t("i",{class:"bi bi-eye me-1"},null,-1),y(" Voir le client ",-1)])]),_:1},8,["href"]),h(s(V),{href:s(k)("customers.index"),class:"btn btn-outline-secondary"},{default:_(()=>[...e[19]||(e[19]=[t("i",{class:"bi bi-arrow-left me-1"},null,-1),y(" Retour à la liste ",-1)])]),_:1},8,["href"])])]),t("form",null,[t("div",S,[t("div",T,[t("div",D,[e[25]||(e[25]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Informations générales")],-1)),t("div",z,[t("div",O,[t("div",P,[e[20]||(e[20]=t("label",{class:"form-label"},[y(" Nom complet "),t("span",{class:"text-danger"},"*")],-1)),v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s(i).name=l),type:"text",required:"",class:f(["form-control",{"is-invalid":s(o).name||n.value.name}]),onBlur:e[1]||(e[1]=l=>p("name",s(i).name)),onInput:e[2]||(e[2]=l=>p("name",s(i).name))},null,34),[[b,s(i).name]]),s(o).name?(d(),m("div",R,r(s(o).name),1)):c("",!0),n.value.name?(d(),m("div",G,r(n.value.name),1)):c("",!0)]),t("div",H,[e[21]||(e[21]=t("label",{class:"form-label"},"Email",-1)),v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s(i).email=l),type:"email",class:f(["form-control",{"is-invalid":s(o).email||n.value.email}]),onBlur:e[4]||(e[4]=l=>p("email",s(i).email)),onInput:e[5]||(e[5]=l=>p("email",s(i).email))},null,34),[[b,s(i).email]]),s(o).email?(d(),m("div",J,r(s(o).email),1)):c("",!0),n.value.email?(d(),m("div",K,r(n.value.email),1)):c("",!0)]),t("div",Q,[e[22]||(e[22]=t("label",{class:"form-label"},"Téléphone",-1)),v(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>s(i).phone=l),type:"tel",class:f(["form-control",{"is-invalid":s(o).phone||n.value.phone}]),onBlur:e[7]||(e[7]=l=>p("phone",s(i).phone)),onInput:e[8]||(e[8]=l=>p("phone",s(i).phone))},null,34),[[b,s(i).phone]]),s(o).phone?(d(),m("div",W,r(s(o).phone),1)):c("",!0),n.value.phone?(d(),m("div",X,r(n.value.phone),1)):c("",!0)]),t("div",Y,[e[24]||(e[24]=t("label",{class:"form-label"},[y(" Limite de crédit "),t("span",{class:"text-danger"},"*")],-1)),t("div",Z,[v(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>s(i).credit_limit=l),type:"number",step:"0.01",min:"0",required:"",class:f(["form-control",{"is-invalid":s(o).credit_limit||n.value.credit_limit}]),onBlur:e[10]||(e[10]=l=>p("credit_limit",s(i).credit_limit)),onInput:e[11]||(e[11]=l=>p("credit_limit",s(i).credit_limit))},null,34),[[b,s(i).credit_limit,void 0,{number:!0}]]),e[23]||(e[23]=t("span",{class:"input-group-text"},"Fcfa",-1))]),s(o).credit_limit?(d(),m("div",ee,r(s(o).credit_limit),1)):c("",!0),n.value.credit_limit?(d(),m("div",se,r(n.value.credit_limit),1)):c("",!0)])])])]),t("div",te,[e[30]||(e[30]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Adresse")],-1)),t("div",ie,[t("div",le,[t("div",oe,[e[26]||(e[26]=t("label",{class:"form-label"},"Adresse",-1)),v(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=l=>s(i).address=l),rows:"3",class:f(["form-control",{"is-invalid":s(o).address}])},null,2),[[b,s(i).address]]),s(o).address?(d(),m("div",ne,r(s(o).address),1)):c("",!0)]),t("div",ae,[e[27]||(e[27]=t("label",{class:"form-label"},"Ville",-1)),v(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>s(i).city=l),type:"text",class:f(["form-control",{"is-invalid":s(o).city}])},null,2),[[b,s(i).city]]),s(o).city?(d(),m("div",de,r(s(o).city),1)):c("",!0)]),t("div",re,[e[28]||(e[28]=t("label",{class:"form-label"},"Code postal",-1)),v(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>s(i).postal_code=l),type:"text",class:f(["form-control",{"is-invalid":s(o).postal_code}])},null,2),[[b,s(i).postal_code]]),s(o).postal_code?(d(),m("div",me,r(s(o).postal_code),1)):c("",!0)]),t("div",ce,[e[29]||(e[29]=t("label",{class:"form-label"},"Pays",-1)),v(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>s(i).country=l),type:"text",class:f(["form-control",{"is-invalid":s(o).country}])},null,2),[[b,s(i).country]]),s(o).country?(d(),m("div",ue,r(s(o).country),1)):c("",!0)])])])]),t("div",ve,[e[33]||(e[33]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Statut")],-1)),t("div",pe,[t("div",fe,[v(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>s(i).is_active=l),class:"form-check-input",type:"checkbox",id:"is_active"},null,512),[[q,s(i).is_active]]),e[31]||(e[31]=t("label",{class:"form-check-label",for:"is_active"}," Client actif ",-1)),e[32]||(e[32]=t("div",{class:"form-text"}," Un client inactif ne sera pas visible dans les ventes ",-1))])])]),t("div",be,[t("button",{type:"button",onClick:C,class:"btn btn-primary",disabled:s(g)},[s(g)?(d(),m("span",_e)):(d(),m("i",ke)),y(" "+r(s(g)?"Modification...":"Modifier le client"),1)],8,ye),h(s(V),{href:s(k)("customers.index"),class:"btn btn-outline-secondary"},{default:_(()=>[...e[34]||(e[34]=[y(" Annuler ",-1)])]),_:1},8,["href"])])])])])]),_:1}))}});export{Ce as default};
