import{d as T,x as L,B as H,c as w,w as h,a as t,t as r,j as K,u,l as C,f as c,b as d,e as i,o,F as S,g as j,s as O,n,h as G}from"./app-CGqa7dvF.js";import{_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-CUowRV7B.js";import{r as x}from"./routes-Ds1K_LXc.js";import{u as W}from"./useSweetAlert-CjcY7Pj8.js";import{u as X}from"./BootstrapLayout-L_TowVZG.js";import"./sweetalert2.esm.all-NNS-RXd7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"d-flex justify-content-between align-items-center mb-4"},Z={class:"h2 mb-1"},Q={class:"text-muted mb-0"},E={class:"d-flex gap-2"},U={class:"row g-4"},tt={class:"col-lg-8"},et={key:0,class:"card mb-4"},st={class:"card-body"},lt={class:"row g-3"},rt=["src","alt"],ot={class:"card"},dt={class:"card-body"},it={class:"row g-3"},at={class:"col-md-6"},ct={class:"mb-0"},nt={class:"col-md-6"},ut={class:"mb-0 font-monospace"},mt={key:0,class:"col-md-6"},bt={class:"mb-0 font-monospace"},ft={class:"col-md-6"},vt={class:"mb-0"},gt={key:1,class:"text-muted"},ht={class:"col-md-6"},xt={class:"mb-0 fw-bold text-success"},kt={key:1,class:"col-md-6"},yt={class:"mb-0"},pt={class:"col-md-6"},_t={class:"mb-0"},wt={key:2,class:"col-md-6"},Ct={class:"mb-0"},St={class:"col-md-6"},jt={class:"mb-0"},Dt={key:3,class:"col-md-6"},Nt={class:"mb-0"},qt={key:4,class:"col-md-6"},At={class:"mb-0"},Ft={class:"badge bg-info"},It={key:0,class:"mt-4"},Pt={class:"mb-0"},$t={key:1,class:"card mt-4"},Bt={class:"card-body"},Mt={class:"table-responsive"},Vt={class:"table table-hover mb-0"},Rt={class:"text-dark"},zt={class:"fw-medium text-success"},Tt={class:"col-lg-4"},Lt={class:"card"},Ht={class:"card-body"},Kt={class:"text-center mb-3"},Ot={class:"text-muted mb-0"},Gt={class:"mb-3"},Jt={class:"mb-0"},Wt={class:"card mt-3"},Xt={class:"card-body"},Yt={class:"row g-3 text-center"},Zt={class:"col-6"},Qt={class:"p-2 bg-light rounded"},Et={class:"fw-bold text-primary"},Ut={class:"col-6"},te={class:"p-2 bg-light rounded"},ee={class:"fw-bold text-success"},se={key:0,class:"card mt-3"},le={class:"card-body"},re={class:"mb-3"},oe={class:"mb-2 fw-bold"},de={key:0},ie={key:0,class:"mb-3"},ae={class:"mb-0"},ce={class:"card mt-3"},ne={class:"card-body"},ue={class:"d-grid gap-2"},ke=T({__name:"Show",props:{product:{}},setup(s){const{canEdit:D,canDelete:N}=X(),k=s,{success:b,error:f,confirm:q}=W(),A=L();H(()=>A.props?.flash,l=>{l?.success&&b(l.success),l?.error&&f(l.error)},{immediate:!0,deep:!0});const m=l=>new Intl.NumberFormat("fr-FR").format(l)+" Fcfa",F=l=>new Intl.NumberFormat("fr-FR").format(l)+" Fcfa",v=l=>new Date(l).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"}),I=(l,e)=>l===0?"text-danger":l<=e?"text-warning":"text-success",P=(l,e)=>l===0?"alert-danger":l<=e?"alert-warning":"alert-success",$=(l,e)=>l===0||l<=e?"bi bi-exclamation-triangle":"bi bi-check-circle",B=(l,e)=>l===0?"Rupture de stock":l<=e?`Stock faible (minimum: ${e})`:"Stock suffisant",M=l=>l==null?"text-muted":l<0||l===0?"text-danger":l<=7?"text-warning":"text-info",y=l=>l==null?"bg-secondary":l<0||l===0?"bg-danger":l<=7?"bg-warning text-dark":"bg-info",g=l=>l==null?"bi bi-calendar":l<0||l===0?"bi bi-exclamation-triangle-fill":l<=7?"bi bi-exclamation-triangle":"bi bi-calendar-check",p=l=>l==null?"Non défini":l<0?`Expiré depuis ${Math.abs(l)} jour(s)`:l===0?"Expire aujourd'hui":`Expire dans ${l} jour(s)`,V=l=>l==null?"alert-secondary":l<0||l===0?"alert-danger":l<=7?"alert-warning":"alert-info",R=l=>l==null?"Date d'expiration non définie":l<0?`⚠️ Ce produit a expiré il y a ${Math.abs(l)} jour(s). Veuillez le retirer de la vente.`:l===0?"⚠️ Ce produit expire aujourd'hui. Action requise immédiatement.":l<=7?`⚠️ Ce produit expire dans ${l} jour(s). Pensez à le vendre en priorité.`:`ℹ️ Ce produit expire dans ${l} jour(s).`,_=l=>l?{days:"jour(s)",weeks:"semaine(s)",months:"mois"}[l]||l:"",z=async()=>{await q("Êtes-vous sûr de vouloir supprimer ce produit ?")&&G.delete(x("products.destroy",{id:k.product.id}),{onSuccess:e=>{e.props?.flash?.success?b(e.props.flash.success):b(`Produit "${k.product.name}" supprimé avec succès !`)},onError:e=>{if(e&&typeof e=="object"){const a=Object.values(e)[0];a&&f(a)}else f("Erreur lors de la suppression du produit.")}})};return(l,e)=>(o(),w(J,null,{default:h(()=>[t("div",Y,[t("div",null,[t("h1",Z,r(s.product.name),1),t("p",Q,r(s.product.sku),1)]),t("div",E,[K(u(C),{href:u(x)("products.index"),class:"btn btn-primary"},{default:h(()=>[...e[0]||(e[0]=[t("i",{class:"bi bi-arrow-left me-1"},null,-1),c(" Retour à la liste ",-1)])]),_:1},8,["href"])])]),t("div",U,[t("div",tt,[s.product.media&&s.product.media.length>0?(o(),d("div",et,[t("div",st,[t("div",lt,[(o(!0),d(S,null,j(s.product.media,a=>(o(),d("div",{key:a.id,class:"col-md-6"},[t("img",{src:a.url,alt:s.product.name,class:"img-fluid rounded",style:{"max-height":"400px","object-fit":"contain"}},null,8,rt)]))),128))])])])):i("",!0),t("div",ot,[e[14]||(e[14]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Informations du produit")],-1)),t("div",dt,[t("div",it,[t("div",at,[e[1]||(e[1]=t("label",{class:"form-label text-muted"},"Nom",-1)),t("p",ct,r(s.product.name),1)]),t("div",nt,[e[2]||(e[2]=t("label",{class:"form-label text-muted"},"SKU",-1)),t("p",ut,r(s.product.sku),1)]),s.product.barcode?(o(),d("div",mt,[e[3]||(e[3]=t("label",{class:"form-label text-muted"},"Code-barres",-1)),t("p",bt,r(s.product.barcode),1)])):i("",!0),t("div",ft,[e[4]||(e[4]=t("label",{class:"form-label text-muted"},"Catégorie",-1)),t("p",vt,[s.product.category?(o(),d("span",{key:0,class:"badge",style:O({backgroundColor:s.product.category.color+"20",color:s.product.category.color})},r(s.product.category.name),5)):(o(),d("span",gt,"Non définie"))])]),t("div",ht,[e[5]||(e[5]=t("label",{class:"form-label text-muted"},"Prix de vente",-1)),t("p",xt,r(m(s.product.price)),1)]),s.product.cost_price?(o(),d("div",kt,[e[6]||(e[6]=t("label",{class:"form-label text-muted"},"Prix de revient",-1)),t("p",yt,r(m(s.product.cost_price)),1)])):i("",!0),t("div",pt,[e[7]||(e[7]=t("label",{class:"form-label text-muted"},"Unité",-1)),t("p",_t,r(s.product.unit),1)]),s.product.location?(o(),d("div",wt,[e[9]||(e[9]=t("label",{class:"form-label text-muted"},"Emplacement",-1)),t("p",Ct,[e[8]||(e[8]=t("i",{class:"bi bi-geo-alt me-1 text-primary"},null,-1)),c(" "+r(s.product.location),1)])])):i("",!0),t("div",St,[e[10]||(e[10]=t("label",{class:"form-label text-muted"},"Statut",-1)),t("p",jt,[t("span",{class:n(["badge",s.product.is_active?"bg-success":"bg-danger"])},[t("i",{class:n(["me-1",s.product.is_active?"bi bi-check-circle":"bi bi-x-circle"])},null,2),c(" "+r(s.product.is_active?"Actif":"Inactif"),1)],2)])]),s.product.expiration_date?(o(),d("div",Dt,[e[11]||(e[11]=t("label",{class:"form-label text-muted"},"Date d'expiration",-1)),t("p",Nt,[t("span",{class:n(M(s.product.days_until_expiration))},[t("i",{class:n([g(s.product.days_until_expiration),"me-1"])},null,2),c(" "+r(v(s.product.expiration_date)),1)],2),s.product.days_until_expiration!==null&&s.product.days_until_expiration!==void 0?(o(),d("span",{key:0,class:n(["badge ms-2",y(s.product.days_until_expiration)])},r(p(s.product.days_until_expiration)),3)):i("",!0)])])):i("",!0),s.product.expiration_date&&(s.product.alert_threshold_value||s.product.alert_threshold_unit)?(o(),d("div",qt,[e[12]||(e[12]=t("label",{class:"form-label text-muted"},"Seuil d'alerte",-1)),t("p",At,[t("span",Ft,r(s.product.alert_threshold_value)+" "+r(_(s.product.alert_threshold_unit))+" avant l'expiration ",1)])])):i("",!0)]),s.product.description?(o(),d("div",It,[e[13]||(e[13]=t("label",{class:"form-label text-muted"},"Description",-1)),t("p",Pt,r(s.product.description),1)])):i("",!0)])]),s.product.saleItems&&s.product.saleItems.length>0?(o(),d("div",$t,[e[16]||(e[16]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Historique des ventes")],-1)),t("div",Bt,[t("div",Mt,[t("table",Vt,[e[15]||(e[15]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Date de vente"),t("th",null,"Numéro de vente"),t("th",null,"Client"),t("th",null,"Quantité"),t("th",null,"Prix unitaire"),t("th",null,"Total")])],-1)),t("tbody",null,[(o(!0),d(S,null,j(s.product.saleItems,a=>(o(),d("tr",{key:a.id},[t("td",null,r(v(a.sale.created_at)),1),t("td",null,[t("code",Rt,r(a.sale.sale_number),1)]),t("td",null,r(a.sale.customer?.name||"Client anonyme"),1),t("td",null,r(a.quantity)+" "+r(s.product.unit),1),t("td",null,r(m(a.unit_price)),1),t("td",zt,r(m(a.total_price)),1)]))),128))])])])])])):i("",!0)]),t("div",Tt,[t("div",Lt,[e[18]||(e[18]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Stock")],-1)),t("div",Ht,[t("div",Kt,[t("div",{class:n(["display-4 fw-bold",I(s.product.stock_quantity,s.product.min_stock_level)])},r(s.product.stock_quantity),3),t("p",Ot,r(s.product.unit),1)]),t("div",Gt,[e[17]||(e[17]=t("label",{class:"form-label text-muted"},"Stock minimum",-1)),t("p",Jt,r(s.product.min_stock_level)+" "+r(s.product.unit),1)]),t("div",{class:n(["alert",P(s.product.stock_quantity,s.product.min_stock_level)]),role:"alert"},[t("i",{class:n([$(s.product.stock_quantity,s.product.min_stock_level),"me-2"])},null,2),c(" "+r(B(s.product.stock_quantity,s.product.min_stock_level)),1)],2)])]),t("div",Wt,[e[21]||(e[21]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Statistiques")],-1)),t("div",Xt,[t("div",Yt,[t("div",Zt,[t("div",Qt,[t("div",Et,r(s.product.sale_items_count||0),1),e[19]||(e[19]=t("div",{class:"small text-muted"},"Ventes",-1))])]),t("div",Ut,[t("div",te,[t("div",ee,r(F(s.product.total_sales||0)),1),e[20]||(e[20]=t("div",{class:"small text-muted"},"Chiffre d'affaires",-1))])])])])]),s.product.expiration_date?(o(),d("div",se,[e[26]||(e[26]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},[t("i",{class:"bi bi-calendar-event me-2"}),c(" Expiration ")])],-1)),t("div",le,[t("div",re,[e[22]||(e[22]=t("label",{class:"form-label text-muted"},"Date d'expiration",-1)),t("p",oe,r(v(s.product.expiration_date)),1),s.product.days_until_expiration!==null&&s.product.days_until_expiration!==void 0?(o(),d("div",de,[t("span",{class:n(["badge",y(s.product.days_until_expiration)])},[t("i",{class:n([g(s.product.days_until_expiration),"me-1"])},null,2),c(" "+r(p(s.product.days_until_expiration)),1)],2)])):i("",!0)]),s.product.alert_threshold_value&&s.product.alert_threshold_unit?(o(),d("div",ie,[e[25]||(e[25]=t("label",{class:"form-label text-muted"},"Configuration de l'alerte",-1)),t("p",ae,[e[23]||(e[23]=c(" Alerte activée ",-1)),t("strong",null,r(s.product.alert_threshold_value)+" "+r(_(s.product.alert_threshold_unit)),1),e[24]||(e[24]=c(" avant l'expiration ",-1))])])):i("",!0),s.product.days_until_expiration!==null&&s.product.days_until_expiration!==void 0?(o(),d("div",{key:1,class:n(["alert",V(s.product.days_until_expiration)]),role:"alert"},[t("i",{class:n([g(s.product.days_until_expiration),"me-2"])},null,2),c(" "+r(R(s.product.days_until_expiration)),1)],2)):i("",!0)])])):i("",!0),t("div",ce,[e[29]||(e[29]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},"Actions rapides")],-1)),t("div",ne,[t("div",ue,[u(D)("products")?(o(),w(u(C),{key:0,href:u(x)("products.edit",{id:s.product.id}),class:"btn btn-outline-primary"},{default:h(()=>[...e[27]||(e[27]=[t("i",{class:"bi bi-pencil me-1"},null,-1),c(" Modifier le produit ",-1)])]),_:1},8,["href"])):i("",!0),u(N)("products")?(o(),d("button",{key:1,onClick:z,class:"btn btn-outline-danger"},[...e[28]||(e[28]=[t("i",{class:"bi bi-trash me-1"},null,-1),c(" Supprimer le produit ",-1)])])):i("",!0)])])])])])]),_:1}))}});export{ke as default};
