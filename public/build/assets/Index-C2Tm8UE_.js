import{E as X,G as $,H as J,d as K,r as M,y as E,c as O,w as S,a as e,b,e as R,j,f as U,u as m,l as N,t as a,m as I,v as B,p as q,o as f,F as z,g as G,n as Y,h as Z}from"./app-DQWaqSr_.js";import{_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-BZ-gD5FF.js";import{r as D}from"./routes-C8N3XD_S.js";import{u as te}from"./useSweetAlert-CjcY7Pj8.js";import{f as se,a as ne}from"./BootstrapLayout-CnHsE3D3.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-NNS-RXd7.js";var le=/\s/;function oe(n){for(var l=n.length;l--&&le.test(n.charAt(l)););return l}var ae=/^\s+/;function re(n){return n&&n.slice(0,oe(n)+1).replace(ae,"")}var P=NaN,de=/^[-+]0x[0-9a-f]+$/i,ue=/^0b[01]+$/i,ce=/^0o[0-7]+$/i,me=parseInt;function Q(n){if(typeof n=="number")return n;if(X(n))return P;if($(n)){var l=typeof n.valueOf=="function"?n.valueOf():n;n=$(l)?l+"":l}if(typeof n!="string")return n===0?n:+n;n=re(n);var u=ue.test(n);return u||ce.test(n)?me(n.slice(2),u?2:8):de.test(n)?P:+n}var W=function(){return J.Date.now()},fe="Expected a function",ve=Math.max,be=Math.min;function pe(n,l,u){var p,g,v,d,o,r,c=0,C=!1,_=!1,T=!0;if(typeof n!="function")throw new TypeError(fe);l=Q(l)||0,$(u)&&(C=!!u.leading,_="maxWait"in u,v=_?ve(Q(u.maxWait)||0,l):v,T="trailing"in u?!!u.trailing:T);function k(t){var s=p,h=g;return p=g=void 0,c=t,d=n.apply(h,s),d}function F(t){return c=t,o=setTimeout(w,l),C?k(t):d}function L(t){var s=t-r,h=t-c,H=l-s;return _?be(H,v-h):H}function y(t){var s=t-r,h=t-c;return r===void 0||s>=l||s<0||_&&h>=v}function w(){var t=W();if(y(t))return x(t);o=setTimeout(w,L(t))}function x(t){return o=void 0,T&&p?k(t):(p=g=void 0,d)}function V(){o!==void 0&&clearTimeout(o),c=0,p=r=g=o=void 0}function A(){return o===void 0?d:x(W())}function i(){var t=W(),s=y(t);if(p=arguments,g=this,r=t,s){if(o===void 0)return F(r);if(_)return clearTimeout(o),o=setTimeout(w,l),k(r)}return o===void 0&&(o=setTimeout(w,l)),d}return i.cancel=V,i.flush=A,i}const he={class:"d-flex justify-content-between align-items-center mb-4"},ge={class:"row mb-4"},_e={class:"col-md-3"},ye={class:"card bg-primary text-white"},xe={class:"card-body"},we={class:"d-flex justify-content-between"},Ce={class:"mb-0"},Te={class:"col-md-3"},ke={class:"card bg-info text-white"},Me={class:"card-body"},Ee={class:"d-flex justify-content-between"},Ie={class:"card-title"},Le={class:"mb-0"},Se={class:"col-md-3"},Ne={class:"card bg-warning text-white"},De={class:"card-body"},Fe={class:"d-flex justify-content-between"},Ve={class:"mb-0"},Ae={class:"col-md-3"},je={class:"card bg-success text-white"},Ue={class:"card-body"},Be={class:"d-flex justify-content-between"},We={class:"mb-0"},$e={class:"card mb-4"},He={class:"card-body"},Oe={class:"row g-3"},Re={class:"col-md-3"},qe={class:"col-md-2"},ze={class:"col-md-2"},Ge={class:"col-md-2"},Pe={class:"col-md-2"},Qe={class:"card"},Xe={class:"card-body p-0"},Je={key:0,class:"text-center py-5"},Ke={key:1,class:"table-responsive"},Ye={class:"table table-hover mb-0"},Ze={class:"badge bg-primary"},et={class:"fw-medium"},tt={key:0,class:"text-muted small"},st={class:"badge bg-info"},nt={class:"fw-bold text-danger"},it={class:"badge bg-secondary"},lt={class:"text-muted small"},ot={class:"d-flex align-items-center"},at={class:"avatar-sm bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2"},rt={class:"fw-medium"},dt={class:"btn-group",role:"group"},ut=["onClick"],ct={key:0,class:"d-flex justify-content-center mt-4"},mt={class:"pagination"},ft=["innerHTML"],vt=K({__name:"Index",props:{expenses:{},statistics:{}},setup(n){const l=n,{success:u,error:p,confirm:g}=te(),v=M(""),d=M(""),o=M(""),r=M(""),c=M(""),C=pe(()=>{},300),_=E(()=>l.statistics?.total||0),T=E(()=>l.statistics?.monthly||0),k=E(()=>l.statistics?.weekly||0),F=E(()=>{const i=new Date().toLocaleDateString("fr-FR",{month:"long"});return i.charAt(0).toUpperCase()+i.slice(1)}),L=E(()=>{let i=l.expenses.data;if(v.value){const t=v.value.toLowerCase();i=i.filter(s=>s.title.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)||s.vendor?.toLowerCase().includes(t)||s.receipt_number?.toLowerCase().includes(t))}return d.value&&(i=i.filter(t=>t.category===d.value)),o.value&&(i=i.filter(t=>t.payment_method===o.value)),r.value&&(i=i.filter(t=>t.expense_date>=r.value)),c.value&&(i=i.filter(t=>t.expense_date<=c.value)),i}),y=i=>new Intl.NumberFormat("fr-FR").format(i)+" Fcfa",w=(i,t)=>i.length>t?i.substring(0,t)+"...":i,x=()=>{},V=()=>{v.value="",d.value="",o.value="",r.value="",c.value=""},A=async i=>{await g(`Êtes-vous sûr de vouloir supprimer la dépense "${i.title}" ?`)&&Z.delete(D("expenses.destroy",{id:i.id}),{onSuccess:()=>{u(`Dépense "${i.title}" supprimée avec succès !`)},onError:s=>{const h=s.message||"Erreur lors de la suppression de la dépense.";p(h)}})};return(i,t)=>(f(),O(ee,null,{default:S(()=>[e("div",he,[t[7]||(t[7]=e("div",null,[e("h1",{class:"h2 mb-1"},[e("i",{class:"bi bi-receipt me-2"}),U(" Gestion des dépenses ")]),e("p",{class:"text-muted mb-0"},"Suivez et gérez toutes vos dépenses")],-1)),j(m(N),{href:m(D)("expenses.create"),class:"btn btn-primary"},{default:S(()=>[...t[6]||(t[6]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),U(" Nouvelle dépense ",-1)])]),_:1},8,["href"])]),e("div",ge,[e("div",_e,[e("div",ye,[e("div",xe,[e("div",we,[e("div",null,[t[8]||(t[8]=e("h6",{class:"card-title"},"Total dépenses",-1)),e("h4",Ce,a(y(_.value)),1)]),t[9]||(t[9]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-currency-exchange fs-1"})],-1))])])])]),e("div",Te,[e("div",ke,[e("div",Me,[e("div",Ee,[e("div",null,[e("h6",Ie,"Ce mois ("+a(F.value)+")",1),e("h4",Le,a(y(T.value)),1)]),t[10]||(t[10]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-calendar-month fs-1"})],-1))])])])]),e("div",Se,[e("div",Ne,[e("div",De,[e("div",Fe,[e("div",null,[t[11]||(t[11]=e("h6",{class:"card-title"},"Cette semaine",-1)),e("h4",Ve,a(y(k.value)),1)]),t[12]||(t[12]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-calendar-week fs-1"})],-1))])])])]),e("div",Ae,[e("div",je,[e("div",Ue,[e("div",Be,[e("div",null,[t[13]||(t[13]=e("h6",{class:"card-title"},"Nombre total",-1)),e("h4",We,a(n.expenses.meta?.total||n.expenses.data.length),1)]),t[14]||(t[14]=e("div",{class:"align-self-center"},[e("i",{class:"bi bi-list-ul fs-1"})],-1))])])])])]),e("div",$e,[e("div",He,[e("div",Oe,[e("div",Re,[t[15]||(t[15]=e("label",{class:"form-label"},"Rechercher",-1)),I(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),type:"text",class:"form-control",placeholder:"Titre, description...",onInput:t[1]||(t[1]=(...s)=>m(C)&&m(C)(...s))},null,544),[[B,v.value]])]),e("div",qe,[t[17]||(t[17]=e("label",{class:"form-label"},"Catégorie",-1)),I(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),class:"form-select",onChange:x},[...t[16]||(t[16]=[e("option",{value:""},"Toutes les catégories",-1),e("option",{value:"fournitures"},"Fournitures",-1),e("option",{value:"equipement"},"Équipement",-1),e("option",{value:"marketing"},"Marketing",-1),e("option",{value:"transport"},"Transport",-1),e("option",{value:"formation"},"Formation",-1),e("option",{value:"maintenance"},"Maintenance",-1),e("option",{value:"utilities"},"Services publics",-1),e("option",{value:"autres"},"Autres",-1)])],544),[[q,d.value]])]),e("div",ze,[t[19]||(t[19]=e("label",{class:"form-label"},"Méthode de paiement",-1)),I(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value=s),class:"form-select",onChange:x},[...t[18]||(t[18]=[e("option",{value:""},"Toutes les méthodes",-1),e("option",{value:"cash"},"Espèces",-1),e("option",{value:"bank_transfer"},"Virement bancaire",-1),e("option",{value:"credit_card"},"Carte de crédit",-1),e("option",{value:"mobile_money"},"Mobile Money",-1),e("option",{value:"orange_money"},"Orange Money",-1),e("option",{value:"wave"},"Wave",-1),e("option",{value:"check"},"Chèque",-1)])],544),[[q,o.value]])]),e("div",Ge,[t[20]||(t[20]=e("label",{class:"form-label"},"Date de début",-1)),I(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value=s),type:"date",class:"form-control",onChange:x},null,544),[[B,r.value]])]),e("div",Pe,[t[21]||(t[21]=e("label",{class:"form-label"},"Date de fin",-1)),I(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>c.value=s),type:"date",class:"form-control",onChange:x},null,544),[[B,c.value]])]),e("div",{class:"col-md-1 d-flex align-items-end"},[e("button",{onClick:V,class:"btn btn-outline-secondary",title:"Effacer les filtres"},[...t[22]||(t[22]=[e("i",{class:"bi bi-x-circle"},null,-1)])])])])])]),e("div",Qe,[t[28]||(t[28]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},[e("i",{class:"bi bi-list-ul me-2"}),U(" Liste des dépenses ")])],-1)),e("div",Xe,[L.value.length===0?(f(),b("div",Je,[...t[23]||(t[23]=[e("i",{class:"bi bi-receipt fs-1 text-muted"},null,-1),e("p",{class:"text-muted mt-3"},"Aucune dépense trouvée",-1)])])):(f(),b("div",Ke,[e("table",Ye,[t[27]||(t[27]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"Numéro"),e("th",null,"Titre"),e("th",null,"Catégorie"),e("th",null,"Montant"),e("th",null,"Méthode de paiement"),e("th",null,"Date"),e("th",null,"Créé par"),e("th",null,"Actions")])],-1)),e("tbody",null,[(f(!0),b(z,null,G(L.value,s=>(f(),b("tr",{key:s.id},[e("td",null,[e("span",Ze,a(s.expense_number),1)]),e("td",null,[e("div",et,a(s.title),1),s.description?(f(),b("div",tt,a(w(s.description,50)),1)):R("",!0)]),e("td",null,[e("span",st,a(s.category_label),1)]),e("td",null,[e("span",nt,a(y(s.amount)),1)]),e("td",null,[e("span",it,a(s.payment_method_label),1)]),e("td",null,[e("div",null,a(m(se)(s.expense_date)),1),e("div",lt,a(m(ne)(s.created_at)),1)]),e("td",null,[e("div",ot,[e("div",at,a(s.user.name.charAt(0).toUpperCase()),1),e("div",null,[e("div",rt,a(s.user.name),1)])])]),e("td",null,[e("div",dt,[j(m(N),{href:m(D)("expenses.show",{id:s.id}),class:"btn btn-sm btn-outline-primary",title:"Voir"},{default:S(()=>[...t[24]||(t[24]=[e("i",{class:"bi bi-eye"},null,-1)])]),_:1},8,["href"]),j(m(N),{href:m(D)("expenses.edit",{id:s.id}),class:"btn btn-sm btn-outline-warning",title:"Modifier"},{default:S(()=>[...t[25]||(t[25]=[e("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["href"]),e("button",{onClick:h=>A(s),class:"btn btn-sm btn-outline-danger",title:"Supprimer"},[...t[26]||(t[26]=[e("i",{class:"bi bi-trash"},null,-1)])],8,ut)])])]))),128))])])]))])]),n.expenses.links?(f(),b("div",ct,[e("nav",null,[e("ul",mt,[(f(!0),b(z,null,G(n.expenses.links,s=>(f(),b("li",{key:s.label,class:Y(["page-item",{active:s.active,disabled:!s.url}])},[s.url?(f(),O(m(N),{key:0,href:s.url,class:"page-link",innerHTML:s.label},null,8,["href","innerHTML"])):(f(),b("span",{key:1,class:"page-link",innerHTML:s.label},null,8,ft))],2))),128))])])])):R("",!0)]),_:1}))}}),wt=ie(vt,[["__scopeId","data-v-d20ec768"]]);export{wt as default};
